
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5. Introduction to Pandas &#8212; Python 数据科学</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css?v=982b99e0" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/myfile.css?v=ced2e0c4" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'introduction-to-pandas';</script>
    <script src="_static/myfile.js?v=78ba3122"></script>
    <script src="_static/.ipynb_checkpoints/myfile-checkpoint.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6. Functions" href="define-function.html" />
    <link rel="prev" title="4. Introduction to Numpy" href="introduction-to-numpy.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Python 数据科学 - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Python 数据科学 - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Preface
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Python Basics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="A-first-look-of-Python.html">1. Getting started with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic-data-type.html">2. Data types in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="print-read-files.html">3. Output, read and write files</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction-to-numpy.html">4. Introduction to Numpy</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">5. Introduction to Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="define-function.html">6. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="draw-pictures.html">7. Draw graphs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python Advanced</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="statistics1.html">8. Python statistics I</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction-to-crawler.html">9. 爬虫入门</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction-to-class.html">10. Python 面向对象编程</a></li>
<li class="toctree-l1"><a class="reference internal" href="good-practices-python.html">11. Python 的良好编程规范</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction-to-parallel.html">12. Python 并行计算</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/RobinChen121/book-Python-Data-Science-en/main?urlpath=lab/tree/data-science-en/introduction-to-pandas.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/RobinChen121/book-Python-Data-Science-en" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/RobinChen121/book-Python-Data-Science-en/issues/new?title=Issue%20on%20page%20%2Fintroduction-to-pandas.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/introduction-to-pandas.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Introduction to Pandas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-reading-and-storing-data">5.1. Creating, Reading, and Storing Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-data">5.1.1. Creating Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-data">5.1.2. Reading Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#store-the-data">5.1.3. Store the data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#access-and-change-data">5.2. Access and change data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-the-data-of-a-single-row-column-or-cell">5.2.1. Access the data of a single row, column or cell</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#acess-multi-row-or-multi-column-data">5.2.2. Acess multi-row or multi-column data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#view-the-statistical-values-of-the-data">5.2.3. View the statistical values of the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#revise-data">5.2.4. Revise data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning">5.3. Data cleaning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-replacement-replace-fillna">5.3.1. Data replacement <code class="docutils literal notranslate"><span class="pre">replace</span></code>, <code class="docutils literal notranslate"><span class="pre">fillna</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cast-the-data-type-astype">5.3.2. Cast the data type <code class="docutils literal notranslate"><span class="pre">astype</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-duplicates-drop-duplicates">5.3.3. Remove duplicates <code class="docutils literal notranslate"><span class="pre">drop_duplicates</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-missing-valuesdropna">5.3.4. Remove missing values<code class="docutils literal notranslate"><span class="pre">dropna</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rename-rename">5.3.5. Rename <code class="docutils literal notranslate"><span class="pre">rename</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-delete-and-merge-data">5.4. Add, delete and merge data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-data">5.4.1. Add data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#delete-data">5.4.2. Delete data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-data">5.4.3. Merge data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-sort-and-group-the-data">5.5. Filter, sort and group the data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-data">5.5.1. Filter data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sort-data">5.5.2. Sort data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#group-the-data-groupby">5.5.3. Group the data <code class="docutils literal notranslate"><span class="pre">groupby</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#method-reset-index-or-argument-as-index-false">5.5.4. Method <code class="docutils literal notranslate"><span class="pre">reset_index()</span></code> or argument <code class="docutils literal notranslate"><span class="pre">as_index=False</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#output-data-to-a-numpy-array-or-a-list">5.6. Output data to a NumPy array or a list</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apply-a-function-method">5.7. Apply a function/method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#process-time-series-data">5.8. Process time-series data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#to-datetime-and-dt-strftime">5.8.1. <code class="docutils literal notranslate"><span class="pre">to_datetime</span></code> and <code class="docutils literal notranslate"><span class="pre">dt.strftime</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-aggregation-resample-1">5.8.2. Data aggregation <code class="docutils literal notranslate"><span class="pre">resample</span></code>* </a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-draw-picutres">5.9. Pandas draw picutres*</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">5.10. Exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="introduction-to-pandas">
<h1><span class="section-number">5. </span>Introduction to Pandas<a class="headerlink" href="#introduction-to-pandas" title="Link to this heading">#</a></h1>
<hr>
<p><code class="docutils literal notranslate"><span class="pre">Pandas</span></code> is one of the most important data analysis tools in Python for data processing. Built on NumPy, it offers many methods for handling large datasets and allows flexible, efficient data manipulation.</p>
<p>The main data type used in pandas is the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, which is a two-dimensional structure similar to a table in Excel. To use pandas, you first need to import it. In fact, the name ‘Pandas’ is short for ‘panel data’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<section id="creating-reading-and-storing-data">
<h2><span class="section-number">5.1. </span>Creating, Reading, and Storing Data<a class="headerlink" href="#creating-reading-and-storing-data" title="Link to this heading">#</a></h2>
<hr>
<section id="creating-data">
<h3><span class="section-number">5.1.1. </span>Creating Data<a class="headerlink" href="#creating-data" title="Link to this heading">#</a></h3>
<hr>
<p>For example, consider the following data:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Name</p></th>
<th class="head text-center"><p>Statistics</p></th>
<th class="head text-center"><p>Accounting</p></th>
<th class="head text-center"><p>Makerting</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Jim</p></td>
<td class="text-center"><p>85</p></td>
<td class="text-center"><p>82</p></td>
<td class="text-center"><p>84</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Lily</p></td>
<td class="text-center"><p>68</p></td>
<td class="text-center"><p>63</p></td>
<td class="text-center"><p>90</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Jack</p></td>
<td class="text-center"><p>90</p></td>
<td class="text-center"><p>88</p></td>
<td class="text-center"><p>78</p></td>
</tr>
</tbody>
</table>
</div>
<p>In general, there are two ways to create a DataFrame.</p>
<ul class="simple">
<li><p>Create the DataFrame by dictionaries <code class="docutils literal notranslate"><span class="pre">dict</span></code>.</p></li>
<li><p>Create the DataFrame by an <code class="docutils literal notranslate"><span class="pre">NumPy</span> <span class="pre">ndarray</span></code> and argumens <code class="docutils literal notranslate"><span class="pre">columns</span></code> or <code class="docutils literal notranslate"><span class="pre">index</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;Jack&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
        <span class="s2">&quot;Accounting&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">82</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span>
        <span class="s2">&quot;Marketing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">78</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Name  Statistics  Accounting  Marketing
0   Jim          85          82         84
1  Lily          68          63         90
2  Jack          90          88         78
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>‘D’ and ‘F’ are capitalized for the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> method.</p>
</div>
<p>Another way to create DataFrame with argument <code class="docutils literal notranslate"><span class="pre">columns</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">84</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Jack&quot;</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">78</span><span class="p">]])</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Accounting&quot;</span><span class="p">,</span> <span class="s2">&quot;Marketing&quot;</span><span class="p">])</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Another way to create DataFrame with both argumens <code class="docutils literal notranslate"><span class="pre">columns</span></code> and <code class="docutils literal notranslate"><span class="pre">index</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">84</span><span class="p">],</span> <span class="p">[</span><span class="mi">68</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">78</span><span class="p">]])</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Accounting&quot;</span><span class="p">,</span> <span class="s2">&quot;Marketing&quot;</span><span class="p">]</span>
<span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;Jack&quot;</span><span class="p">]</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="n">columns</span>
<span class="p">)</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jim</th>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>Lily</th>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>Jack</th>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In the above outputs, the first row are column lables while the first column are row indices. We can visit them by <code class="docutils literal notranslate"><span class="pre">columns</span></code> and <code class="docutils literal notranslate"><span class="pre">index</span></code>, respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Name&#39;, &#39;Statistics&#39;, &#39;Accounting&#39;, &#39;Marketing&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RangeIndex(start=0, stop=3, step=1)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>One column or row data of a DataFrame is called a <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Statistics&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.series.Series
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Get the number of rows and columns in a DataFrame by <code class="docutils literal notranslate"><span class="pre">shape</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3, 4)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Get the number of cells in a DataFrame by <code class="docutils literal notranslate"><span class="pre">size</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Get the data types of each column by <code class="docutils literal notranslate"><span class="pre">dtypes</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Name          object
Statistics     int64
Accounting     int64
Marketing      int64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Pandas also supports converting one-dimensional or two-dimensional arrays/lists directly into DataFrame format.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="reading-data">
<h3><span class="section-number">5.1.2. </span>Reading Data<a class="headerlink" href="#reading-data" title="Link to this heading">#</a></h3>
<hr>
<p>In most cases, we need to read data files (such as Excel files). Suppose the example above is saved in an Excel file named ‘transcripts.xlsx’ located in the “datas/” directory on your computer. We can read the file using the <code class="docutils literal notranslate"><span class="pre">read_excel</span></code> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;datas/transcripts.xlsx&quot;</span><span class="p">)</span>
<span class="c1"># or df = pd.read_excel(&quot;datas\\transcripts.xlsx&quot;)</span>
<span class="c1"># or df = pd.read_excel(r&quot;datas\transcripts.xlsx&quot;)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>File paths on macOS use the forward slash <code class="docutils literal notranslate"><span class="pre">/</span></code> as a separator, while Windows uses the backslash <code class="docutils literal notranslate"><span class="pre">\</span></code>.</p></li>
<li><p>Adding an <code class="docutils literal notranslate"><span class="pre">r</span></code> before a file path string (e.g., r”path”) preserves the original meaning of the string and prevents special characters from being escaped.</p></li>
</ul>
</div>
<p>The syntax for <code class="docutils literal notranslate"><span class="pre">read_excel</span></code>is:</p>
<table>   
    <tr style="border-top:solid; border-bottom:solid">
        <th colspan=2 style="text-align:center">
            read_excel(io, sheetname=0, header=0, skiprows=None, index_col=None, encoding=None)
        </th>
    </tr>
    <tr>
        <td style="text-align:left">io</td>
        <td style="text-align:left">The file path and name of the data file, usually provided as a string.</td>
    </tr>
    <tr>
        <td style="text-align:left">sheetname</td>
        <td style="text-align:left">The name or index of the worksheet. Defaults to 0, which reads the first sheet.</td>
    </tr>
    <tr>
        <td style="text-align:left">header</td>
        <td style="text-align:left">The row to use as column names. Defaults to 0, meaning the first row is used as headers.</td>
    </tr>
    <tr>
        <td style="text-align:left">skiprows</td>
        <td style="text-align:left">Number of rows to skip from the top of the file.</td>
    </tr>
    <tr>
        <td style="text-align:left">index_col</td>
        <td style="text-align:left">Column to use as the row labels of the DataFrame.</td>
    </tr>
    <tr style="border-bottom:solid">
        <td style="text-align:left">encoding</td>
        <td style="text-align:left">Encoding format, commonly 'gbk' or 'utf-8'.</td>
    </tr>
</table><div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>When reading certain data files, you may need to add the decoding argument <code class="docutils literal notranslate"><span class="pre">encoding='gbk'</span></code> or <code class="docutils literal notranslate"><span class="pre">encoding='utf-8'</span></code> for proper reading.</p></li>
</ul>
</div>
<p>Another common data file format is CSV (CSV is short for comma separated values). We can simply use Pandas’ <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> method, whose syntax is essentially the same as <code class="docutils literal notranslate"><span class="pre">read_excel</span></code>.</p>
</section>
<section id="store-the-data">
<h3><span class="section-number">5.1.3. </span>Store the data<a class="headerlink" href="#store-the-data" title="Link to this heading">#</a></h3>
<hr>
<p>To save data, use the <code class="docutils literal notranslate"><span class="pre">to_excel</span></code> or <code class="docutils literal notranslate"><span class="pre">to_csv</span></code> method. For example, to save our DataFrame df to the “datas/” folder with the filename “marks.xlsx”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&quot;datas/marks.xlsx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>The folder must first exists in the computer before using <code class="docutils literal notranslate"><span class="pre">to_excel</span></code> or <code class="docutils literal notranslate"><span class="pre">to_csv</span></code>.</p></li>
<li><p>By default, the row indeices are not written to the file. If you want to include the index in the saved file, you can set <code class="docutils literal notranslate"><span class="pre">index=True</span></code> (the default is index=False).</p></li>
</ul>
</section>
</section>
<section id="access-and-change-data">
<h2><span class="section-number">5.2. </span>Access and change data<a class="headerlink" href="#access-and-change-data" title="Link to this heading">#</a></h2>
<hr>
<p>To quickly view the statistical summary of each column in a DataFrame, you can use the <code class="docutils literal notranslate"><span class="pre">describe()</span></code> method. It includes information such as the number of non-null values, mean, standard deviation, minimum, maximum, and quartiles for each column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>81.000000</td>
      <td>77.666667</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>std</th>
      <td>11.532563</td>
      <td>13.051181</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>min</th>
      <td>68.000000</td>
      <td>63.000000</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>76.500000</td>
      <td>72.500000</td>
      <td>81.0</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>85.000000</td>
      <td>82.000000</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>87.500000</td>
      <td>85.000000</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>max</th>
      <td>90.000000</td>
      <td>88.000000</td>
      <td>90.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Additionally, there are several useful method:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">info()</span></code></p></td>
<td><p>View the data type of each column</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">head(n=5)</span></code></p></td>
<td><p>View the first n (default is 5) rows of the data</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tail(n=5)</span></code></p></td>
<td><p>View the last n (default is 5)rows of the data</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># view the first 2 rows</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="access-the-data-of-a-single-row-column-or-cell">
<h3><span class="section-number">5.2.1. </span>Access the data of a single row, column or cell<a class="headerlink" href="#access-the-data-of-a-single-row-column-or-cell" title="Link to this heading">#</a></h3>
<hr>
<p>The simplest way to view a specific column of data is by entering the column name within square brackets <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code>. For example, to view the ‘Marketing’ scores column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Marketing&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    84
1    90
2    78
Name: Marketing, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>To view a particular row of data, use the <code class="docutils literal notranslate"><span class="pre">loc[</span> <span class="pre">]</span></code> method with the row index.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># show the data of the first row</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Name          Jim
Statistics     85
Accounting     82
Marketing      84
Name: 0, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># show the data of the 3rd row</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Name          Jack
Statistics      90
Accounting      88
Marketing       78
Name: 2, dtype: object
</pre></div>
</div>
</div>
</div>
<p>To view a specific cell, a convenient method is to use double square brackets <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">][</span> <span class="pre">]</span></code>, with the column label and row index inside each bracket respectively; Another way is to put the row index and column label insider <code class="docutils literal notranslate"><span class="pre">loc[</span> <span class="pre">]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Marketing&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>90
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Marketing&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>90
</pre></div>
</div>
</div>
</div>
</section>
<section id="acess-multi-row-or-multi-column-data">
<h3><span class="section-number">5.2.2. </span>Acess multi-row or multi-column data<a class="headerlink" href="#acess-multi-row-or-multi-column-data" title="Link to this heading">#</a></h3>
<hr>
<p>To view multiple rows and columns of data, you can use <code class="docutils literal notranslate"><span class="pre">iloc[</span> <span class="pre">]</span></code>, which not only allows accessing multiple rows and columns but also supports retrieving single rows, single columns, or even individual cell data.。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># view the data in the 2nd row</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Name          Lily
Statistics      68
Accounting      63
Marketing       90
Name: 1, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># view the data of the first 2 rows</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>  <span class="c1"># view the data of the 1st and the 3rd rows</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>View the column data with <code class="docutils literal notranslate"><span class="pre">[:,</span> <span class="pre">]</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># view the data of the 2nd column</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    85
1    68
2    90
Name: Statistics, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># view the data of the first 2 columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>  <span class="c1"># view the data of the 1st and 3rd columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Accounting</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>82</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>63</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>88</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>View the data in a block.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># view the data in the first 2 rows and the first 2 columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>  <span class="c1"># view the data in row 1 and 3, column 1 and 3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Accounting</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>82</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>88</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># view the data in row 1 and 3, column 1 and 2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>View the data in some cell.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># view the data in the cell of row 1 and column 1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>68
</pre></div>
</div>
</div>
</div>
<p>To view specific columns of data, in addition to using <code class="docutils literal notranslate"><span class="pre">iloc</span></code>, you can <strong>directly pass a list of column labels inside square brackets <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code></strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Marketing&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>85</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>68</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>90</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>It is same as the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>85</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>68</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>90</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="view-the-statistical-values-of-the-data">
<h3><span class="section-number">5.2.3. </span>View the statistical values of the data<a class="headerlink" href="#view-the-statistical-values-of-the-data" title="Link to this heading">#</a></h3>
<hr>
<p>Pandas provides built-in statistical method to calculate summary statistics for column data. These method include: <code class="docutils literal notranslate"><span class="pre">mean()</span></code> (average), <code class="docutils literal notranslate"><span class="pre">max()</span></code> (maximum), <code class="docutils literal notranslate"><span class="pre">min()</span></code> (minimum), <code class="docutils literal notranslate"><span class="pre">median()</span></code>, <code class="docutils literal notranslate"><span class="pre">std()</span></code> (standard deviation), <code class="docutils literal notranslate"><span class="pre">count()</span></code>, <code class="docutils literal notranslate"><span class="pre">skew()</span></code> (skewness), <code class="docutils literal notranslate"><span class="pre">quantile()</span></code>, and more. In some cases, you may need to specify the argument <code class="docutils literal notranslate"><span class="pre">numeric_only=True</span></code> to ensure the method is only applied to numeric columns.</p>
<ul class="simple">
<li><p>Sometimes we may need to cast the data types to numeric before using those methods.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>81.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to calculate the average score for each course</span>
<span class="c1"># since the first column (&#39;names&#39;) is non-numeric, the argument numeric_only=True is added.`</span>
<span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Statistics    81.000000
Accounting    77.666667
Marketing     84.000000
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Accounting&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>88
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Using ‘axis=1’ to apply the function to rows</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># computer the average score of each student</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    83.666667
1    73.666667
2    85.333333
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="revise-data">
<h3><span class="section-number">5.2.4. </span>Revise data<a class="headerlink" href="#revise-data" title="Link to this heading">#</a></h3>
<hr>
<p>When modifying data in a pandas DataFrame, you can assign new values based on pandas index positions: <strong>either assigning a column/row to a single value or to a list with equal length</strong>, using <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code> and <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code>, respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Accounting&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">80</span>  <span class="c1"># revise all the accounting scores to 80</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>80</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>80</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>80</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Accounting&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">88</span><span class="p">]</span>  <span class="c1"># revise the accounting scores to be the list values</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>64</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>76</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">80</span>  <span class="c1"># revise all the values in row 2 to 80</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>64</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>80</td>
      <td>80</td>
      <td>80</td>
      <td>80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Ella&quot;</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">89</span><span class="p">]</span>  <span class="c1"># revise all the values in row 2 to the list values</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>64</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ella</td>
      <td>95</td>
      <td>90</td>
      <td>89</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Revise the value in some cell:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">55</span>  
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>64</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ella</td>
      <td>55</td>
      <td>90</td>
      <td>89</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To change the data type of column, using method <code class="docutils literal notranslate"><span class="pre">astype()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Marketing&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    84.0
1    89.0
2    78.0
Name: Marketing, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="data-cleaning">
<h2><span class="section-number">5.3. </span>Data cleaning<a class="headerlink" href="#data-cleaning" title="Link to this heading">#</a></h2>
<hr>
<section id="data-replacement-replace-fillna">
<h3><span class="section-number">5.3.1. </span>Data replacement <code class="docutils literal notranslate"><span class="pre">replace</span></code>, <code class="docutils literal notranslate"><span class="pre">fillna</span></code><a class="headerlink" href="#data-replacement-replace-fillna" title="Link to this heading">#</a></h3>
<hr>
<p>When processing data, it is often necessary to perform batch operations on outliers or erroneous values in the raw data. Pandas provides the replace method to facilitate this task conveniently. The first argument of the replace method is the original value in the data, and the second argument is the value to be replaced.</p>
<p>For example, consider the following student grades:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">[[</span><span class="mi">55</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">70</span><span class="p">],</span> <span class="p">[</span><span class="mi">52</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">68</span><span class="p">],</span> <span class="p">[</span><span class="mi">74</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">58</span><span class="p">]],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">,</span> <span class="s2">&quot;Finance&quot;</span><span class="p">],</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Jack&quot;</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;Tom&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
      <th>Python</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jack</th>
      <td>55</td>
      <td>68</td>
      <td>70</td>
    </tr>
    <tr>
      <th>Lily</th>
      <td>52</td>
      <td>63</td>
      <td>68</td>
    </tr>
    <tr>
      <th>Tom</th>
      <td>74</td>
      <td>60</td>
      <td>58</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Replace the score 68 with 65:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">68</span><span class="p">,</span> <span class="mi">65</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
      <th>Python</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jack</th>
      <td>55</td>
      <td>68</td>
      <td>70</td>
    </tr>
    <tr>
      <th>Lily</th>
      <td>52</td>
      <td>63</td>
      <td>68</td>
    </tr>
    <tr>
      <th>Tom</th>
      <td>74</td>
      <td>60</td>
      <td>58</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The original data does not change. To change the original data, we need addtional argument <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>.</p>
<ul class="simple">
<li><p>The methods <code class="docutils literal notranslate"><span class="pre">fillna</span></code>, <code class="docutils literal notranslate"><span class="pre">drop_duplicates</span></code>,<code class="docutils literal notranslate"><span class="pre">dropna</span></code>,<code class="docutils literal notranslate"><span class="pre">rename</span></code> can also add the argument<code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> to change the original data.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">68</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
      <th>Python</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jack</th>
      <td>55</td>
      <td>65</td>
      <td>70</td>
    </tr>
    <tr>
      <th>Lily</th>
      <td>52</td>
      <td>63</td>
      <td>65</td>
    </tr>
    <tr>
      <th>Tom</th>
      <td>74</td>
      <td>60</td>
      <td>58</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Pandas provides the <code class="docutils literal notranslate"><span class="pre">fillna</span></code> method to batch replace missing values (NaN) in a data table.</p>
<ul class="simple">
<li><p>When reading some data files by Pandas, some blank cells will be treated as Numpy’s NaN (Not a Number) type.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">55</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">70</span><span class="p">],</span> <span class="p">[</span><span class="mi">52</span><span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">68</span><span class="p">],</span> <span class="p">[</span><span class="mi">74</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]]),</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">,</span> <span class="s2">&quot;Finance&quot;</span><span class="p">],</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Jack&quot;</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;Tom&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
      <th>Python</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jack</th>
      <td>55.0</td>
      <td>68.0</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>Lily</th>
      <td>52.0</td>
      <td>NaN</td>
      <td>68.0</td>
    </tr>
    <tr>
      <th>Tom</th>
      <td>74.0</td>
      <td>60.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>  <span class="c1"># replace NaN with 80</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
      <th>Python</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jack</th>
      <td>55.0</td>
      <td>68.0</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>Lily</th>
      <td>52.0</td>
      <td>80.0</td>
      <td>68.0</td>
    </tr>
    <tr>
      <th>Tom</th>
      <td>74.0</td>
      <td>60.0</td>
      <td>80.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Pandas can sue the method <code class="docutils literal notranslate"><span class="pre">isnull</span></code>to evaluate whether the cell value is null：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Finance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jack    False
Lily    False
Tom      True
Name: Finance, dtype: bool
</pre></div>
</div>
</div>
</div>
</section>
<section id="cast-the-data-type-astype">
<h3><span class="section-number">5.3.2. </span>Cast the data type <code class="docutils literal notranslate"><span class="pre">astype</span></code><a class="headerlink" href="#cast-the-data-type-astype" title="Link to this heading">#</a></h3>
<hr>
<p>Frquently, we need to perform data transformations on raw data. For example, if some numerical values in the original data are stored as text, we must convert them into numeric types before performing subsequent calculations. A commonly used method for data type conversion is <code class="docutils literal notranslate"><span class="pre">astype</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">[[</span><span class="s2">&quot;55&quot;</span><span class="p">,</span> <span class="s2">&quot;68&quot;</span><span class="p">,</span> <span class="s2">&quot;70&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;52&quot;</span><span class="p">,</span> <span class="s2">&quot;63&quot;</span><span class="p">,</span> <span class="s2">&quot;68&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;74&quot;</span><span class="p">,</span> <span class="s2">&quot;60&quot;</span><span class="p">,</span> <span class="s2">&quot;58&quot;</span><span class="p">]],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">,</span> <span class="s2">&quot;Finance&quot;</span><span class="p">],</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Jack&quot;</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;Tom&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
      <th>Python</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jack</th>
      <td>55</td>
      <td>68</td>
      <td>70</td>
    </tr>
    <tr>
      <th>Lily</th>
      <td>52</td>
      <td>63</td>
      <td>68</td>
    </tr>
    <tr>
      <th>Tom</th>
      <td>74</td>
      <td>60</td>
      <td>58</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Check the data types of each column by the method <code class="docutils literal notranslate"><span class="pre">dtypes</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Statistics    object
Python        object
Finance       object
dtype: object
</pre></div>
</div>
</div>
</div>
<p>We use <code class="docutils literal notranslate"><span class="pre">astype</span></code> cast the data type of each folumn to type float.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">,</span> <span class="s2">&quot;Finance&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">,</span> <span class="s2">&quot;Finance&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
      <th>Python</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jack</th>
      <td>55.0</td>
      <td>68.0</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>Lily</th>
      <td>52.0</td>
      <td>63.0</td>
      <td>68.0</td>
    </tr>
    <tr>
      <th>Tom</th>
      <td>74.0</td>
      <td>60.0</td>
      <td>58.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Statistics    float64
Python        float64
Finance       float64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>We can also change the data type to string or integer by modifying the argument of <code class="docutils literal notranslate"><span class="pre">astype</span></code> to <code class="docutils literal notranslate"><span class="pre">str</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code>.</p>
</section>
<section id="remove-duplicates-drop-duplicates">
<h3><span class="section-number">5.3.3. </span>Remove duplicates <code class="docutils literal notranslate"><span class="pre">drop_duplicates</span></code><a class="headerlink" href="#remove-duplicates-drop-duplicates" title="Link to this heading">#</a></h3>
<hr>
<p>When dealing with large datasets, duplicate data is a common issue. The <code class="docutils literal notranslate"><span class="pre">drop_duplicates</span></code> method can be used to remove redundant entries. For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">84</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">84</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Jack&quot;</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">78</span><span class="p">]])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Accounting&quot;</span><span class="p">,</span> <span class="s2">&quot;Marketing&quot;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We use <code class="docutils literal notranslate"><span class="pre">drop_duplicates</span></code> to drop the identical rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The syntax of drop_duplicates is as follows:</p>
<p>Syntax of the drop_duplicates function:</p>
<table>
     <tr style="border-top:solid; border-bottom:solid">
            <th colspan=2 style="text-align:center">DataFrame.drop_duplicates(keep='first', inplace=False, ignore_index=False)</th>
    </tr>
    <tr>
        <td rowspan=3 style="text-align:left">keep</td>
        <td style="text-align:left">'first': Keep first occurrence, remove subsequent duplicates (default)</td>
    </tr>
    <tr>
        <td style="text-align:left">'last': Keep last occurrence, remove previous duplicates</td>
    </tr>
    <tr>
        <td style="text-align:left">False: Remove all duplicates</td>
    </tr>
    <tr>
        <td style="text-align:left">inplace</td>
        <td style="text-align:left">If True, modifies the DataFrame in place without returning a new object</td>
    </tr>
    <tr style="border-bottom:solid">
        <td style="text-align:left">ignore_index</td>
        <td style="text-align:left">If True, the resulting DataFrame's index will be relabeled (default False)</td>
    </tr>
</table>
<br></section>
<section id="remove-missing-valuesdropna">
<h3><span class="section-number">5.3.4. </span>Remove missing values<code class="docutils literal notranslate"><span class="pre">dropna</span></code><a class="headerlink" href="#remove-missing-valuesdropna" title="Link to this heading">#</a></h3>
<hr><p><code class="docutils literal notranslate"><span class="pre">dropna</span></code> can drop the missing values in a Dataframe. Its syntax is as follows:</p>
<table>
     <tr style="border-top:solid; border-bottom:solid">
            <th colspan=2 style="text-align:center">DataFrame.dropna(axis=0, how='any', thresh=None, inplace=False, ignore_index=False)</th>
    </tr>
    <tr>
        <td style="text-align:left">axis</td>
        <td style="text-align:left">axis=0 drops rows containing missing values, axis=1 drops columns containing missing values</td>
    </tr>
    <tr>
        <td rowspan=2 style="text-align:left">how</td>
        <td style="text-align:left">Default how='any': drops row/column if any values are missing</td>
    </tr>
    <tr>  
        <td style="text-align:left">how='all': drops row/column only if all values are missing</td>
    </tr>
    <tr>
        <td style="text-align:left">thresh</td>
        <td style="text-align:left">Minimum number of non-missing values required to keep the row/column</td>
    </tr>
    <tr>
        <td style="text-align:left">inplace</td>
        <td style="text-align:left">If True, modifies the DataFrame in place without returning a new object</td>
    </tr>
    <tr style="border-bottom:solid">
        <td style="text-align:left">ignore_index</td>
        <td style="text-align:left">If True, the resulting DataFrame's index will be reset (default False)</td>
    </tr>
</table>
<br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">55</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">70</span><span class="p">],</span> <span class="p">[</span><span class="mi">52</span><span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">68</span><span class="p">],</span> <span class="p">[</span><span class="mi">74</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]]),</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">,</span> <span class="s2">&quot;Finance&quot;</span><span class="p">],</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Jack&quot;</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;Tom&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
      <th>Python</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jack</th>
      <td>55.0</td>
      <td>68.0</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>Lily</th>
      <td>52.0</td>
      <td>NaN</td>
      <td>68.0</td>
    </tr>
    <tr>
      <th>Tom</th>
      <td>74.0</td>
      <td>60.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>  <span class="c1"># drop all the rows with NaN</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
      <th>Python</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jack</th>
      <td>55.0</td>
      <td>68.0</td>
      <td>70.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># drop all the columns with NaN</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jack</th>
      <td>55.0</td>
    </tr>
    <tr>
      <th>Lily</th>
      <td>52.0</td>
    </tr>
    <tr>
      <th>Tom</th>
      <td>74.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
      <th>Python</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jack</th>
      <td>55.0</td>
      <td>68.0</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>Lily</th>
      <td>52.0</td>
      <td>NaN</td>
      <td>68.0</td>
    </tr>
    <tr>
      <th>Tom</th>
      <td>74.0</td>
      <td>60.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="rename-rename">
<h3><span class="section-number">5.3.5. </span>Rename <code class="docutils literal notranslate"><span class="pre">rename</span></code><a class="headerlink" href="#rename-rename" title="Link to this heading">#</a></h3>
<hr>
<p>When working with data, we may sometimes need to rename the row or column labels. This is where the rename function comes into play. The rename function takes a dictionary as its argument, where:</p>
<ul class="simple">
<li><p>The dictionary keys represent the current names (to be replaced).</p></li>
<li><p>The dictionary values represent the new names.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">84</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Jack&quot;</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">78</span><span class="p">]])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Accounting&quot;</span><span class="p">,</span> <span class="s2">&quot;Marketing&quot;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Statistics&quot;</span><span class="p">:</span> <span class="s2">&quot;Python&quot;</span><span class="p">,</span> <span class="s2">&quot;Accouting&quot;</span><span class="p">:</span> <span class="s2">&quot;Finance&quot;</span><span class="p">})</span>  <span class="c1"># rename two column labels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Python</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Use the argument <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> if wanting to change the original data.</p></li>
</ul>
</section>
</section>
<section id="add-delete-and-merge-data">
<h2><span class="section-number">5.4. </span>Add, delete and merge data<a class="headerlink" href="#add-delete-and-merge-data" title="Link to this heading">#</a></h2>
<hr><section id="add-data">
<h3><span class="section-number">5.4.1. </span>Add data<a class="headerlink" href="#add-data" title="Link to this heading">#</a></h3>
<hr>
<p>To add a new column at the end of the original data, the syntax is similar to revising the data, using <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code> and <code class="docutils literal notranslate"><span class="pre">.loc[</span> <span class="pre">]</span></code> for adding columns or rows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Python Programming&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">60</span> <span class="c1"># add one column of data in which all the values equal a single value</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python Programming</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
      <td>60</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
      <td>60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
      <td>60</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Financing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">70</span><span class="p">]</span> <span class="c1"># add one column of data in which the values equal to a list</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python Programming</th>
      <th>Financing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
      <td>60</td>
      <td>50</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
      <td>60</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To add a new row at the end of the original data, using <code class="docutils literal notranslate"><span class="pre">.loc[</span> <span class="pre">]</span></code>.</p>
<ul class="simple">
<li><p>not <code class="docutils literal notranslate"><span class="pre">.iloc[</span> <span class="pre">]</span></code>, which can’t enlarge the DataFrame.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">3</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;David&quot;</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">83</span><span class="p">]</span> 
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python Programming</th>
      <th>Financing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
      <td>60.0</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
      <td>60.0</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
      <td>60.0</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>David</td>
      <td>65</td>
      <td>70</td>
      <td>69</td>
      <td>55.0</td>
      <td>83.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If inserting a column to specific index, using the method <code class="docutils literal notranslate"><span class="pre">insert</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Economy&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">61</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">81</span><span class="p">])</span>  <span class="c1"># insert a new column at column index 1</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Economy</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python Programming</th>
      <th>Financing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>61</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
      <td>60.0</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>72</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
      <td>60.0</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>84</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
      <td>60.0</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>David</td>
      <td>81</td>
      <td>65</td>
      <td>70</td>
      <td>69</td>
      <td>55.0</td>
      <td>83.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To insert rows at a specific position, Pandas currently does not have a dedicated method for this operation. The common approach is to use the <code class="docutils literal notranslate"><span class="pre">concat()</span></code> method to combine multiple DataFrames. Additionally, both <code class="docutils literal notranslate"><span class="pre">concat()</span></code> and <code class="docutils literal notranslate"><span class="pre">merge()</span></code> can be used to add multiple columns or rows. For detailed usage, please refer to the “Merge Data” section later in this documentation.</p>
</section>
<section id="delete-data">
<h3><span class="section-number">5.4.2. </span>Delete data<a class="headerlink" href="#delete-data" title="Link to this heading">#</a></h3>
<hr><p>Pandas can use the <code class="docutils literal notranslate"><span class="pre">drop()</span></code> method to remove rows or columns. <strong>To delete a row, specify the row index as the argument along with <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code></strong>. If the argument<code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> is omitted, the original DataFrame remains unchanged.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># delete the 3rd row</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Economy</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python Programming</th>
      <th>Financing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>61</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
      <td>60.0</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>72</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
      <td>60.0</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>84</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
      <td>60.0</td>
      <td>70.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>To delete a column, using <code class="docutils literal notranslate"><span class="pre">drop()</span> </code> with an additional argument <code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">=</span> <span class="pre">1</span></code>**</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Python Programming&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Economy</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Financing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>61</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>72</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>84</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
      <td>70.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>To delete multi rows or columns, using <code class="docutils literal notranslate"><span class="pre">drop()</span></code> with the indices or lables in a list.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;Marketing&quot;</span><span class="p">,</span> <span class="s2">&quot;Financing&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># delete two columns</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Economy</th>
      <th>Statistics</th>
      <th>Accounting</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>61</td>
      <td>85</td>
      <td>82</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>72</td>
      <td>68</td>
      <td>63</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>84</td>
      <td>90</td>
      <td>88</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># delete two rows</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Economy</th>
      <th>Statistics</th>
      <th>Accounting</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>72</td>
      <td>68</td>
      <td>63</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">drop()</span></code> method can drop data with conditions. For example:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;Jack&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
        <span class="s2">&quot;Accounting&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">82</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span>
        <span class="s2">&quot;Marketing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">78</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">70</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># delete the rows in which the statistics score is higher than 70</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Using <code class="docutils literal notranslate"><span class="pre">reset_index(drop=True)</span></code> to reset the row indices and drop the original indices</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="merge-data">
<h3><span class="section-number">5.4.3. </span>Merge data<a class="headerlink" href="#merge-data" title="Link to this heading">#</a></h3>
<hr>
<p>In Pandas, two commonly used method for combining datasets are concat and merge.</p>
<ul class="simple">
<li><p>Use concat when the two DataFrames have identical column labels.</p></li>
<li><p>In other cases, merge is typically preferred.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;Jack&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
        <span class="s2">&quot;Accounting&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">82</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span>
        <span class="s2">&quot;Marketing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">78</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;David&quot;</span><span class="p">,</span> <span class="s2">&quot;Ella&quot;</span><span class="p">],</span> <span class="s2">&quot;Statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">83</span><span class="p">,</span> <span class="mi">59</span><span class="p">],</span> <span class="s2">&quot;Accounting&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">62</span><span class="p">,</span> <span class="mi">70</span><span class="p">],</span> <span class="s2">&quot;Marketing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">78</span><span class="p">]}</span>
<span class="p">)</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>David</td>
      <td>83</td>
      <td>62</td>
      <td>64</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ella</td>
      <td>59</td>
      <td>70</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Since the two DataFrames have same column lables, using <code class="docutils literal notranslate"><span class="pre">concat([</span> <span class="pre">])</span></code>and put the two DataFrames <strong>in a list</strong> to merge.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">])</span>  <span class="c1">#  there are square brackets [ ]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
    <tr>
      <th>0</th>
      <td>David</td>
      <td>83</td>
      <td>62</td>
      <td>64</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ella</td>
      <td>59</td>
      <td>70</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To rename the indexes after merging, you can add the argument <code class="docutils literal notranslate"><span class="pre">ignore_index=True</span></code>, which will reassign sequential numeric indexes starting from 0 to the merged data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
    <tr>
      <th>3</th>
      <td>David</td>
      <td>83</td>
      <td>62</td>
      <td>64</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ella</td>
      <td>59</td>
      <td>70</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>concat 默认按行合并，若按列合并，可以在小括号内添加参数<code class="docutils literal notranslate"><span class="pre">axis=1</span></code></p></li>
</ul>
<p>假如有下面的数据：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;Jack&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Python&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">65</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span>
        <span class="s2">&quot;Business Modelling&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">72</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">78</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Python</th>
      <th>Business Modelling</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>65</td>
      <td>72</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>60</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>When df1 and df3 share the same ‘Name’ column but have different other column names, and we want to add df3’s columns to df1, we should use the <code class="docutils literal notranslate"><span class="pre">merge()</span></code> method. The typical syntax is as follows:</p>
<table>
    <tr style="border-top:solid; border-bottom:solid">
        <th colspan=2 style="text-align:center">DataFrame.merge(right, how='inner', on=None)</th>
    </tr>
    <tr>
        <td style="text-align:left">right</td>
        <td style="text-align:left">The other DataFrame to merge;</td>
    </tr>
    <tr>
        <td rowspan=4 style="text-align:left">how</td>
        <td style="text-align:left">Default 'inner': performs inner join, merging only matching keys from both DataFrames</td>
    </tr>
    <tr>
        <td style="text-align:left">'outer': performs full outer join, merging all keys from both DataFrames</td>
    </tr>
    <tr>
        <td style="text-align:left">'left': performs left join, preserving all keys from the left DataFrame</td>
    </tr>
    <tr>
        <td style="text-align:left">'right': performs right join, preserving all keys from the right DataFrame</td>
    </tr>
    <tr style="border-bottom:solid">
        <td style="text-align:left">on</td>
        <td style="text-align:left">Column labels to join on (single or multiple)</td>
    </tr>
</table><p>So, for df1 and df3, when using <code class="docutils literal notranslate"><span class="pre">merge</span></code>, the matching key is ‘Name’:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df3</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python</th>
      <th>Business Modelling</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
      <td>65</td>
      <td>72</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
      <td>68</td>
      <td>63</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
      <td>60</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>When merging DataFrames, Pandas will automatically fill missing values with NaN for non-matching fields. The following example demonstrates the results of different join method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;Robert&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Python&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">65</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span>
        <span class="s2">&quot;Business Modelling&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">68</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">df4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Python</th>
      <th>Business Modelling</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>65</td>
      <td>72</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>78</td>
      <td>73</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Robert</td>
      <td>60</td>
      <td>68</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df4</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python</th>
      <th>Business Modelling</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
      <td>65</td>
      <td>72</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
      <td>78</td>
      <td>73</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df4</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python</th>
      <th>Business Modelling</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jack</td>
      <td>90.0</td>
      <td>88.0</td>
      <td>78.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jim</td>
      <td>85.0</td>
      <td>82.0</td>
      <td>84.0</td>
      <td>65.0</td>
      <td>72.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lily</td>
      <td>68.0</td>
      <td>63.0</td>
      <td>90.0</td>
      <td>78.0</td>
      <td>73.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robert</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>60.0</td>
      <td>68.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df4</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python</th>
      <th>Business Modelling</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
      <td>65.0</td>
      <td>72.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
      <td>78.0</td>
      <td>73.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df4</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python</th>
      <th>Business Modelling</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85.0</td>
      <td>82.0</td>
      <td>84.0</td>
      <td>65</td>
      <td>72</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68.0</td>
      <td>63.0</td>
      <td>90.0</td>
      <td>78</td>
      <td>73</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Robert</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>60</td>
      <td>68</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="filter-sort-and-group-the-data">
<h2><span class="section-number">5.5. </span>Filter, sort and group the data<a class="headerlink" href="#filter-sort-and-group-the-data" title="Link to this heading">#</a></h2>
<hr>
<section id="filter-data">
<h3><span class="section-number">5.5.1. </span>Filter data<a class="headerlink" href="#filter-data" title="Link to this heading">#</a></h3>
<hr>
<p>When querying DataFrame data based on certain conditions, some comparison operators are commonly used, such as: <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">==</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">!=</span></code>. Conditional queries are generally applied only to column data. During the query process, <strong>Pandas first generates a Boolean index (True or False)</strong> and then produces the queried data by specifying this index.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;Jack&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
        <span class="s2">&quot;Accounting&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">82</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span>
        <span class="s2">&quot;Marketing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">78</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">70</span>  <span class="c1">#  get the boolean index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     True
1    False
2     True
Name: Statistics, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">70</span><span class="p">]</span>  <span class="c1"># get the conditional data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>For multi-condition queries, you can use <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> to represent <strong>AND</strong> (both conditions must be satisfied) and <code class="docutils literal notranslate"><span class="pre">|</span></code> to represent <strong>OR</strong> (either condition can be satisfied). And, <strong>each condition is in the paratheses <code class="docutils literal notranslate"><span class="pre">(</span> <span class="pre">)</span></code></strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">70</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Marketing&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">80</span><span class="p">)]</span>  <span class="c1"># get the data where statistics score is greater than 70, and marketing score is greater than 80</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">70</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Marketing&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">80</span><span class="p">)]</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>We can get the unique values of a column using the method <code class="docutils literal notranslate"><span class="pre">unique()</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;Jack&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">82</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">82</span><span class="p">],</span>
        <span class="s2">&quot;Accounting&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">72</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">72</span><span class="p">],</span>
        <span class="s2">&quot;Marketing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">78</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>82</td>
      <td>72</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>82</td>
      <td>72</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Accounting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([72, 63])
</pre></div>
</div>
</div>
</div>
</section>
<section id="sort-data">
<h3><span class="section-number">5.5.2. </span>Sort data<a class="headerlink" href="#sort-data" title="Link to this heading">#</a></h3>
<hr>
<p>When working with data, sorting is often necessary. Pandas provides a convenient method called <code class="docutils literal notranslate"><span class="pre">sort_values</span></code> for sorting numerical data. Its syntax is as follows:</p>
<table>
     <tr style="border-top:solid; border-bottom:solid">
            <th colspan=2 style="text-align:center">DataFrame.sort_values(by, axis=0, ascending=True, inplace=False,  na_position='last', ignore_index=False)</th>
    </tr>
    <tr>
        <td style="text-align:left">by</td>
        <td style="text-align:left">Column labels to sort by (axis=0) or row indices (axis=1); multiple values allowed</td>
    </tr>
    <tr>
        <td style="text-align:left">axis</td>
        <td style="text-align:left">0 for column-wise sorting, 1 for row-wise sorting (default: 0)</td>
    </tr>
    <tr>
        <td style="text-align:left">ascending</td>
        <td style="text-align:left">Sort order: True for ascending, False for descending (default: True)</td>
    </tr>
    <tr>
        <td style="text-align:left">inplace</td>
        <td style="text-align:left">Whether to modify the DataFrame in place (default: False)</td>
    </tr>
    <tr>
        <td style="text-align:left">na_position</td>
        <td style="text-align:left">Position for missing values: 'first' or 'last' (default: 'last')</td>
    </tr>
    <tr style="border-bottom:solid">
        <td style="text-align:left">ignore_index</td>
        <td style="text-align:left">If True, the resulting axis will be labeled 0, 1, ..., n-1 (default: False)</td>
    </tr>
</table>
<br><p>Sort the scores of Statistics in ascending order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Statistics&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>82</td>
      <td>72</td>
      <td>84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>82</td>
      <td>72</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Sory the scores of both Statistics and Marketing in descending order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Marketing&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>82</td>
      <td>72</td>
      <td>84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>82</td>
      <td>72</td>
      <td>78</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>For the argument <code class="docutils literal notranslate"><span class="pre">by</span></code>, with “Statistics” preceding “Advanced Mathematics”, it means: first sort by Statistics scores in descending order, and for entries with identical Statistics scores, then sort by Advanced Mathematics scores in descending order.</p>
<p>Since column labels often get shuffled during sorting:</p>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">ignore_index</span> <span class="pre">=</span> <span class="pre">True</span></code> to reset the index labels sequentially.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">inplace</span> <span class="pre">=</span> <span class="pre">True</span></code> to modify the original DataFrame directly.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Marketing&quot;</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># reset the index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jack</td>
      <td>82</td>
      <td>72</td>
      <td>78</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jim</td>
      <td>82</td>
      <td>72</td>
      <td>84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Marketing&quot;</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
<span class="n">df</span> <span class="c1"># the original data keeps same</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>82</td>
      <td>72</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>82</td>
      <td>72</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Marketing&quot;</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">df</span> <span class="c1"># the original data is changed after adding `inplace=True`</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jack</td>
      <td>82</td>
      <td>72</td>
      <td>78</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jim</td>
      <td>82</td>
      <td>72</td>
      <td>84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="group-the-data-groupby">
<h3><span class="section-number">5.5.3. </span>Group the data <code class="docutils literal notranslate"><span class="pre">groupby</span></code><a class="headerlink" href="#group-the-data-groupby" title="Link to this heading">#</a></h3>
<hr>
<p>In data analysis, it’s often necessary to group and aggregate data. For example, when analyzing students’ final exam scores, you might need to calculate average scores, highest scores, etc. by major or class. Pandas’ <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> method conveniently implements these operations.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">groupby</span></code> operation is frequently combined with aggregation method such as:</p>
<ul class="simple">
<li><p>mean (average)</p></li>
<li><p>max (maximum value)</p></li>
<li><p>min (minimum value)</p></li>
<li><p>median (median)</p></li>
<li><p>std (standard deviation)</p></li>
<li><p>mad (mean absolute deviation)</p></li>
<li><p>count (number of non-null values)</p></li>
<li><p>size (total count, including nulls)</p></li>
<li><p>skew (skewness)</p></li>
<li><p>quantile (quantile values)</p></li>
</ul>
<p>Below is a DataFrame about transcript.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;US&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;Tom&quot;</span><span class="p">,</span> <span class="s2">&quot;UK&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;Jack&quot;</span><span class="p">,</span> <span class="s2">&quot;India&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">78</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;David&quot;</span><span class="p">,</span> <span class="s2">&quot;UK&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">80</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;Ella&quot;</span><span class="p">,</span> <span class="s2">&quot;India&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">63</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;Julie&quot;</span><span class="p">,</span> <span class="s2">&quot;China&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">93</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Nation&quot;</span><span class="p">,</span> <span class="s2">&quot;Level&quot;</span><span class="p">,</span> <span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Accounting&quot;</span><span class="p">,</span> <span class="s2">&quot;Finance&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Nation</th>
      <th>Level</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Lily</td>
      <td>US</td>
      <td>5</td>
      <td>85</td>
      <td>68</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tom</td>
      <td>UK</td>
      <td>6</td>
      <td>82</td>
      <td>63</td>
      <td>88</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>India</td>
      <td>6</td>
      <td>84</td>
      <td>90</td>
      <td>78</td>
    </tr>
    <tr>
      <th>3</th>
      <td>David</td>
      <td>UK</td>
      <td>6</td>
      <td>75</td>
      <td>68</td>
      <td>80</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ella</td>
      <td>India</td>
      <td>5</td>
      <td>69</td>
      <td>55</td>
      <td>63</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Julie</td>
      <td>China</td>
      <td>5</td>
      <td>89</td>
      <td>95</td>
      <td>93</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Level&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="c1"># group by &#39;Level&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Nation</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Finance</th>
    </tr>
    <tr>
      <th>Level</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Level&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Level
5    3
6    3
dtype: int64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">numeric_only</span> <span class="pre">=</span> <span class="pre">True</span></code> to operate only on the numeric values</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Level&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
    <span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>  <span class="c1"># Get the mean scores for each module by &quot;Level&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Finance</th>
    </tr>
    <tr>
      <th>Level</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>81.000000</td>
      <td>72.666667</td>
      <td>82.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>80.333333</td>
      <td>73.666667</td>
      <td>82.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Nation&quot;</span><span class="p">,</span> <span class="s2">&quot;Level&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Finance</th>
    </tr>
    <tr>
      <th>Nation</th>
      <th>Level</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>China</th>
      <th>5</th>
      <td>89.0</td>
      <td>95.0</td>
      <td>93.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">India</th>
      <th>5</th>
      <td>69.0</td>
      <td>55.0</td>
      <td>63.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>84.0</td>
      <td>90.0</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>UK</th>
      <th>6</th>
      <td>78.5</td>
      <td>65.5</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>US</th>
      <th>5</th>
      <td>85.0</td>
      <td>68.0</td>
      <td>90.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can assign the data after grouping to a new DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Nation&quot;</span><span class="p">,</span> <span class="s2">&quot;Level&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Finance</th>
    </tr>
    <tr>
      <th>Nation</th>
      <th>Level</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>China</th>
      <th>5</th>
      <td>89.0</td>
      <td>95.0</td>
      <td>93.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">India</th>
      <th>5</th>
      <td>69.0</td>
      <td>55.0</td>
      <td>63.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>84.0</td>
      <td>90.0</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>UK</th>
      <th>6</th>
      <td>78.5</td>
      <td>65.5</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>US</th>
      <th>5</th>
      <td>85.0</td>
      <td>68.0</td>
      <td>90.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MultiIndex([(&#39;China&#39;, &#39;5&#39;),
            (&#39;India&#39;, &#39;5&#39;),
            (&#39;India&#39;, &#39;6&#39;),
            (   &#39;UK&#39;, &#39;6&#39;),
            (   &#39;US&#39;, &#39;5&#39;)],
           names=[&#39;Nation&#39;, &#39;Level&#39;])
</pre></div>
</div>
</div>
</div>
</section>
<section id="method-reset-index-or-argument-as-index-false">
<h3><span class="section-number">5.5.4. </span>Method <code class="docutils literal notranslate"><span class="pre">reset_index()</span></code> or argument <code class="docutils literal notranslate"><span class="pre">as_index=False</span></code><a class="headerlink" href="#method-reset-index-or-argument-as-index-false" title="Link to this heading">#</a></h3>
<hr>
<p>The indices of a DataFrame often change after Pandas processing, as have mentioned before, we have two ways to stop the changes.</p>
<ul class="simple">
<li><p>Use a method <code class="docutils literal notranslate"><span class="pre">reset_index()</span></code>.</p></li>
<li><p>Use an argument <code class="docutils literal notranslate"><span class="pre">as_index=False</span></code> inside some method.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Nation&quot;</span><span class="p">,</span> <span class="s2">&quot;Level&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Nation</th>
      <th>Level</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>China</td>
      <td>5</td>
      <td>89.0</td>
      <td>95.0</td>
      <td>93.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>India</td>
      <td>5</td>
      <td>69.0</td>
      <td>55.0</td>
      <td>63.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>India</td>
      <td>6</td>
      <td>84.0</td>
      <td>90.0</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>UK</td>
      <td>6</td>
      <td>78.5</td>
      <td>65.5</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US</td>
      <td>5</td>
      <td>85.0</td>
      <td>68.0</td>
      <td>90.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Nation&quot;</span><span class="p">,</span> <span class="s2">&quot;Level&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Nation</th>
      <th>Level</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>China</td>
      <td>5</td>
      <td>89.0</td>
      <td>95.0</td>
      <td>93.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>India</td>
      <td>5</td>
      <td>69.0</td>
      <td>55.0</td>
      <td>63.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>India</td>
      <td>6</td>
      <td>84.0</td>
      <td>90.0</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>UK</td>
      <td>6</td>
      <td>78.5</td>
      <td>65.5</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US</td>
      <td>5</td>
      <td>85.0</td>
      <td>68.0</td>
      <td>90.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Sometimes, the <code class="docutils literal notranslate"><span class="pre">reset_index()</span></code> method can be used with the <code class="docutils literal notranslate"><span class="pre">drop=True</span></code> argument to remove the index.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">reset_index()</span></code> method can also use the <code class="docutils literal notranslate"><span class="pre">names</span></code> argument to rename column headers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Nation&quot;</span><span class="p">,</span> <span class="s2">&quot;Level&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Class&quot;</span><span class="p">,</span> <span class="s2">&quot;Gender&quot;</span><span class="p">])</span>
<span class="p">)</span> 
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Class</th>
      <th>Gender</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>China</td>
      <td>5</td>
      <td>89.0</td>
      <td>95.0</td>
      <td>93.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>India</td>
      <td>5</td>
      <td>69.0</td>
      <td>55.0</td>
      <td>63.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>India</td>
      <td>6</td>
      <td>84.0</td>
      <td>90.0</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>UK</td>
      <td>6</td>
      <td>78.5</td>
      <td>65.5</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US</td>
      <td>5</td>
      <td>85.0</td>
      <td>68.0</td>
      <td>90.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Class&#39;, &#39;Gender&#39;, &#39;Statistics&#39;, &#39;Accounting&#39;, &#39;Finance&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="output-data-to-a-numpy-array-or-a-list">
<h2><span class="section-number">5.6. </span>Output data to a NumPy array or a list<a class="headerlink" href="#output-data-to-a-numpy-array-or-a-list" title="Link to this heading">#</a></h2>
<hr><p>In Pandas, the <code class="docutils literal notranslate"><span class="pre">values</span></code> method can convert DataFrame data into a NumPy array format. For example, using the previous data example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[&#39;Lily&#39;, &#39;US&#39;, &#39;5&#39;, 85, 68, 90],
       [&#39;Tom&#39;, &#39;UK&#39;, &#39;6&#39;, 82, 63, 88],
       [&#39;Jack&#39;, &#39;India&#39;, &#39;6&#39;, 84, 90, 78],
       [&#39;David&#39;, &#39;UK&#39;, &#39;6&#39;, 75, 68, 80],
       [&#39;Ella&#39;, &#39;India&#39;, &#39;5&#39;, 69, 55, 63],
       [&#39;Julie&#39;, &#39;China&#39;, &#39;5&#39;, 89, 95, 93]], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Accounting&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[85, 68],
       [82, 63],
       [84, 90],
       [75, 68],
       [69, 55],
       [89, 95]])
</pre></div>
</div>
</div>
</div>
<p>You can also use the <code class="docutils literal notranslate"><span class="pre">tolist()</span></code> method to convert a column of data into Python’s native list type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[85, 82, 84, 75, 69, 89]
</pre></div>
</div>
</div>
</div>
</section>
<section id="apply-a-function-method">
<h2><span class="section-number">5.7. </span>Apply a function/method<a class="headerlink" href="#apply-a-function-method" title="Link to this heading">#</a></h2>
<hr>
<p>Pandas can use the method <code class="docutils literal notranslate"><span class="pre">apply</span></code> to apply a function/method to the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">)</span>  <span class="c1"># apply the method sqrt in NumPy to compute the squre root of a colun</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    9.219544
1    9.055385
2    9.165151
3    8.660254
4    8.306624
5    9.433981
Name: Statistics, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We can also self define a <code class="docutils literal notranslate"><span class="pre">lambda</span></code> fuction inside <code class="docutils literal notranslate"><span class="pre">apply(</span> <span class="pre">)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;new Statistics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># minus every score in &quot;Statistics&quot; by 10 to a new column</span>
<span class="n">df</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Nation</th>
      <th>Level</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Finance</th>
      <th>new Statistics</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Lily</td>
      <td>US</td>
      <td>5</td>
      <td>85</td>
      <td>68</td>
      <td>90</td>
      <td>75</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tom</td>
      <td>UK</td>
      <td>6</td>
      <td>82</td>
      <td>63</td>
      <td>88</td>
      <td>72</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>India</td>
      <td>6</td>
      <td>84</td>
      <td>90</td>
      <td>78</td>
      <td>74</td>
    </tr>
    <tr>
      <th>3</th>
      <td>David</td>
      <td>UK</td>
      <td>6</td>
      <td>75</td>
      <td>68</td>
      <td>80</td>
      <td>65</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ella</td>
      <td>India</td>
      <td>5</td>
      <td>69</td>
      <td>55</td>
      <td>63</td>
      <td>59</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Julie</td>
      <td>China</td>
      <td>5</td>
      <td>89</td>
      <td>95</td>
      <td>93</td>
      <td>79</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">apply</span></code> can also apply other more complex self defined function. For example, the following code transfers the numeric scores in other forms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">replace_score</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">70</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;A&quot;</span>
    <span class="k">elif</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">60</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;B&quot;</span>
    <span class="k">elif</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">50</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;C&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Failed&quot;</span>


<span class="n">df</span><span class="p">[</span><span class="s2">&quot;new Statistics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;new Statistics&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_score</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Nation</th>
      <th>Level</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Finance</th>
      <th>new Statistics</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Lily</td>
      <td>US</td>
      <td>5</td>
      <td>85</td>
      <td>68</td>
      <td>90</td>
      <td>A</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tom</td>
      <td>UK</td>
      <td>6</td>
      <td>82</td>
      <td>63</td>
      <td>88</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>India</td>
      <td>6</td>
      <td>84</td>
      <td>90</td>
      <td>78</td>
      <td>A</td>
    </tr>
    <tr>
      <th>3</th>
      <td>David</td>
      <td>UK</td>
      <td>6</td>
      <td>75</td>
      <td>68</td>
      <td>80</td>
      <td>B</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ella</td>
      <td>India</td>
      <td>5</td>
      <td>69</td>
      <td>55</td>
      <td>63</td>
      <td>C</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Julie</td>
      <td>China</td>
      <td>5</td>
      <td>89</td>
      <td>95</td>
      <td>93</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="process-time-series-data">
<h2><span class="section-number">5.8. </span>Process time-series data<a class="headerlink" href="#process-time-series-data" title="Link to this heading">#</a></h2>
<hr>
<section id="to-datetime-and-dt-strftime">
<h3><span class="section-number">5.8.1. </span><code class="docutils literal notranslate"><span class="pre">to_datetime</span></code> and <code class="docutils literal notranslate"><span class="pre">dt.strftime</span></code><a class="headerlink" href="#to-datetime-and-dt-strftime" title="Link to this heading">#</a></h3>
<hr>
<p>In practical work, we often encounter large amounts of time series data. The raw time series data is typically in text format, which needs to be converted into datetime format. Pandas provides the <code class="docutils literal notranslate"><span class="pre">to_datetime</span></code> method to convert other datetime formats into Python’s datetime format. For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;20200514&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2020-05-14 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;2020/05/14&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2020-05-14 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;2020-05-14&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2020-05-14 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<p>在上面的代码中可以看出，<code class="docutils literal notranslate"><span class="pre">to_datetime</span></code>方法将不同类型的时间数据字符串转化为 Timestamp 格式：<code class="docutils literal notranslate"><span class="pre">年-月-日</span> <span class="pre">时:分:秒</span></code>。另外一个函数<code class="docutils literal notranslate"><span class="pre">dt.strftime</span></code>可以将 Pandas 的 Timestamp 格式数据转化为其他格式的字符串，例如：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Enrollment date&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2016-09-15&quot;</span><span class="p">,</span> <span class="s2">&quot;2017-03-23&quot;</span><span class="p">,</span> <span class="s2">&quot;2018-09-05&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">65</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">70</span><span class="p">],</span>
        <span class="s2">&quot;Python&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">62</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">78</span><span class="p">],</span>
        <span class="s2">&quot;Finance&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">78</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Enrollment date</th>
      <th>Statistics</th>
      <th>Python</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-09-15</td>
      <td>65</td>
      <td>62</td>
      <td>64</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017-03-23</td>
      <td>58</td>
      <td>63</td>
      <td>60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2018-09-05</td>
      <td>70</td>
      <td>78</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># original date string</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;2016-09-15&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Enrollment date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Enrollment date&quot;</span><span class="p">])</span>  <span class="c1"># change original date to Python&#39;s Timestamp type</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Enrollment date</th>
      <th>Statistics</th>
      <th>Python</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-09-15</td>
      <td>65</td>
      <td>62</td>
      <td>64</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017-03-23</td>
      <td>58</td>
      <td>63</td>
      <td>60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2018-09-05</td>
      <td>70</td>
      <td>78</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2016-09-15 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Enrollment date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%m-</span><span class="si">%d</span><span class="s2">-%y&quot;</span><span class="p">)</span>  <span class="c1"># change the date to specific format</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    09-15-16
1    03-23-17
2    09-05-18
Name: Enrollment date, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Enrollment date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%m-</span><span class="si">%d</span><span class="s2">-%Y&quot;</span><span class="p">)</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    09-15-2016
1    03-23-2017
2    09-05-2018
Name: Enrollment date, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Enrollment date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%D&quot;</span><span class="p">)</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    09/15/16
1    03/23/17
2    09/05/18
Name: Enrollment date, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Enrollment date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%W&quot;</span><span class="p">)</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    2016-37
1    2017-12
2    2018-36
Name: Enrollment date, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Enrollment date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-%w&quot;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    2016-09-4
1    2017-03-4
2    2018-09-3
Name: Enrollment date, dtype: object
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-aggregation-resample-1">
<h3><span class="section-number">5.8.2. </span>Data aggregation <code class="docutils literal notranslate"><span class="pre">resample</span></code>* <a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a><a class="headerlink" href="#data-aggregation-resample-1" title="Link to this heading">#</a></h3>
<hr>
<p>For many time-series datasets, it’s often necessary to aggregate data at specific periodic intervals. This can be achieved using Pandas’ <code class="docutils literal notranslate"><span class="pre">resample</span></code> method. To use this method, the DataFrame must have a datetime-like index.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;12/24/2019&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>  <span class="c1"># generate a date range</span>
<span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2019-12-24&#39;, &#39;2019-12-25&#39;, &#39;2019-12-26&#39;, &#39;2019-12-27&#39;,
               &#39;2019-12-28&#39;, &#39;2019-12-29&#39;, &#39;2019-12-30&#39;, &#39;2019-12-31&#39;,
               &#39;2020-01-01&#39;, &#39;2020-01-02&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>  <span class="c1"># generate a DataFrame with data range as index</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-12-24</th>
      <td>0</td>
    </tr>
    <tr>
      <th>2019-12-25</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2019-12-26</th>
      <td>2</td>
    </tr>
    <tr>
      <th>2019-12-27</th>
      <td>3</td>
    </tr>
    <tr>
      <th>2019-12-28</th>
      <td>4</td>
    </tr>
    <tr>
      <th>2019-12-29</th>
      <td>5</td>
    </tr>
    <tr>
      <th>2019-12-30</th>
      <td>6</td>
    </tr>
    <tr>
      <th>2019-12-31</th>
      <td>7</td>
    </tr>
    <tr>
      <th>2020-01-01</th>
      <td>8</td>
    </tr>
    <tr>
      <th>2020-01-02</th>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;ME&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># use resample to sum the data every month</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-12-31</th>
      <td>28</td>
    </tr>
    <tr>
      <th>2020-01-31</th>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;3D&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># use resample to sum the data every 3 days</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-12-24</th>
      <td>3</td>
    </tr>
    <tr>
      <th>2019-12-27</th>
      <td>12</td>
    </tr>
    <tr>
      <th>2019-12-30</th>
      <td>21</td>
    </tr>
    <tr>
      <th>2020-01-02</th>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;W&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># use resample to sum the data every week</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-12-29</th>
      <td>15</td>
    </tr>
    <tr>
      <th>2020-01-05</th>
      <td>30</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In the resample method’s arguments, <code class="docutils literal notranslate"><span class="pre">T</span></code> represents minutes and <code class="docutils literal notranslate"><span class="pre">H</span></code> represents hours. Besides being used with the <code class="docutils literal notranslate"><span class="pre">sum()</span></code> method, it can also be combined with:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">asfreq()</span></code> → Returns the value at the specified frequency (without aggregation).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ffill()</span></code> → Forward fills missing values after resampling.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">apply()</span></code> → Applies a custom aggregation function.</p></li>
</ul>
</section>
</section>
<section id="pandas-draw-picutres">
<h2><span class="section-number">5.9. </span>Pandas draw picutres*<a class="headerlink" href="#pandas-draw-picutres" title="Link to this heading">#</a></h2>
<hr>
<p>In addition to visualization with Matplotlib and Seaborn, Pandas also provides its own plotting function plot(). The basic syntax is as follows:</p>
<table>
     <tr style="border-top:solid; border-bottom:solid">
            <th colspan=2 style="text-align:center">DataFrame.plot(x=None, y=None, kind='line', subplots=False, title=None)</th>
    </tr>
    <tr>
        <td style="text-align:left">x</td>
        <td style="text-align:left">Column name for x-axis data</td>
    </tr>
    <tr>
        <td style="text-align:left">y</td>
        <td style="text-align:left">Column name(s) for y-axis data</td>
    </tr>
    <tr>  
        <td style="text-align:left">kind</td>
        <td style="text-align:left">Plot type (default: 'line'). Options: 'bar', 'barh', 'box', 'pie', 'scatter', 'hist', etc.</td>
    </tr>
    <tr>
        <td style="text-align:left">subplots</td>
        <td style="text-align:left">Whether to generate separate subplots for each column (True/False)</td>
    </tr>
    <tr style="border-bottom:solid">
        <td style="text-align:left">title</td>
        <td style="text-align:left">Title of the plot</td>
    </tr>
</table>
<br><ul class="simple">
<li><p>We load a dataset ‘iris’ from seaborn.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;iris&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
      <td>virginica</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/c335d8a410ec96c85f481b3a1cdf477b3593b3711150b7bb7b1b6632e1dcc412.png" src="_images/c335d8a410ec96c85f481b3a1cdf477b3593b3711150b7bb7b1b6632e1dcc412.png" />
</div>
</div>
<p>The above picture shows that the <code class="docutils literal notranslate"><span class="pre">plot</span></code> method of Pandas draw a line chart for each numeric column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;hist&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;My picture&quot;</span><span class="p">)</span>  <span class="c1"># draw a histogram chart for a column</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: title={&#39;center&#39;: &#39;My picture&#39;}, ylabel=&#39;Frequency&#39;&gt;
</pre></div>
</div>
<img alt="_images/ae07780ca140c74ccd847ac55325b029e40230c0ffb0d8d4f789a978d4846da7.png" src="_images/ae07780ca140c74ccd847ac55325b029e40230c0ffb0d8d4f789a978d4846da7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;sepal_length&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;sepal_width&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;scatter&quot;</span><span class="p">)</span>  <span class="c1"># draw scatter chart with given axis</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;sepal_length&#39;, ylabel=&#39;sepal_width&#39;&gt;
</pre></div>
</div>
<img alt="_images/f05ab40ee11aabe85dce858a34a996483f10d3b29b37725e4c5872f82ca2400e.png" src="_images/f05ab40ee11aabe85dce858a34a996483f10d3b29b37725e4c5872f82ca2400e.png" />
</div>
</div>
<p>Pandas provides a comprehensive set of data processing methods with numerous argument configurations. Due to space limitations, this book does not elaborate on them in detail. When using Pandas for data processing, readers are encouraged to consult the <a class="reference external" href="https://pandas.pydata.org/docs/">official documentation</a> for further reference.</p>
</section>
<section id="exercises">
<h2><span class="section-number">5.10. </span>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<hr><div class="exercise admonition" id="creat-df">

<p class="admonition-title"><span class="caption-number">Exercise 5.1 </span></p>
<section id="exercise-content">
<p>How to creat a DataFrame ‘df’ for the following panel data?</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Nation</p></th>
<th class="head"><p>Capital</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>UK</p></td>
<td><p>London</p></td>
</tr>
<tr class="row-odd"><td><p>US</p></td>
<td><p>Washington DC</p></td>
</tr>
<tr class="row-even"><td><p>China</p></td>
<td><p>Beijing</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-1">

<p class="admonition-title">Solution to<a class="reference internal" href="#creat-df"> Exercise 5.1</a></p>
<section id="solution-content">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Nation&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;UK&#39;</span><span class="p">,</span> <span class="s1">&#39;US&#39;</span><span class="p">,</span> <span class="s1">&#39;China&#39;</span><span class="p">],</span> <span class="s1">&#39;Capital&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;London&#39;</span><span class="p">,</span> <span class="s1">&#39;Washinton DC&#39;</span><span class="p">,</span> <span class="s1">&#39;Beijing&#39;</span><span class="p">]})</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s1">&#39;UK&#39;</span><span class="p">,</span> <span class="s1">&#39;US&#39;</span><span class="p">,</span> <span class="s1">&#39;China&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;London&#39;</span><span class="p">,</span> <span class="s1">&#39;Washinton DC&#39;</span><span class="p">,</span> <span class="s1">&#39;Beijing&#39;</span><span class="p">]])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Nation&#39;</span><span class="p">,</span> <span class="s1">&#39;Capital&#39;</span><span class="p">])</span>
</pre></div>
</div>
</section>
</div>
<div class="exercise admonition" id="view-cell">

<p class="admonition-title"><span class="caption-number">Exercise 5.2 </span></p>
<section id="exercise-content">
<p>How to view the cell ‘London’ of the following DataFrame?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Nation&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;UK&#39;</span><span class="p">,</span> <span class="s1">&#39;US&#39;</span><span class="p">,</span> <span class="s1">&#39;China&#39;</span><span class="p">],</span> <span class="s1">&#39;Capital&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;London&#39;</span><span class="p">,</span> <span class="s1">&#39;Washinton DC&#39;</span><span class="p">,</span> <span class="s1">&#39;Beijing&#39;</span><span class="p">]})</span><span class="s1">&#39;?</span>
</pre></div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-3">

<p class="admonition-title">Solution to<a class="reference internal" href="#view-cell"> Exercise 5.2</a></p>
<section id="solution-content">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Capital&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Capital&#39;</span><span class="p">]</span>
</pre></div>
</div>
</section>
</div>
<div class="exercise admonition" id="read-csv">

<p class="admonition-title"><span class="caption-number">Exercise 5.3 </span></p>
<section id="exercise-content">
<p>How to read a CSV file into a Pandas DataFrame?</p>
<p>A.    pd.load_csv()</p>
<p>B.    pd.read_csv()</p>
<p>C.    pd.open_csv()</p>
<p>D.    pd.import_csv()</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-5">

<p class="admonition-title">Solution to<a class="reference internal" href="#read-csv"> Exercise 5.3</a></p>
<section id="solution-content">
<p>B</p>
</section>
</div>
<div class="exercise admonition" id="row-index">

<p class="admonition-title"><span class="caption-number">Exercise 5.4 </span></p>
<section id="exercise-content">
<p>What is the default index type when a DataFrame is created?</p>
<p>A.    Numeric index starting from 1</p>
<p>B.    Alphanumeric index based on row number</p>
<p>C.    Numeric index starting from 0</p>
<p>D.    Strings</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-7">

<p class="admonition-title">Solution to<a class="reference internal" href="#row-index"> Exercise 5.4</a></p>
<section id="solution-content">
<p>C</p>
</section>
</div>
<div class="exercise admonition" id="acess-data">

<p class="admonition-title"><span class="caption-number">Exercise 5.5 </span></p>
<section id="exercise-content">
<p>How can you select a specific column ‘Score’ from a DataFrame ‘df’?</p>
<p>A.    df(‘Score’)</p>
<p>B.    df.select_column(‘Score’)</p>
<p>C.    df.get_column(‘Score’)</p>
<p>D.    df[‘Score’]</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-9">

<p class="admonition-title">Solution to<a class="reference internal" href="#acess-data"> Exercise 5.5</a></p>
<section id="solution-content">
<p>D</p>
</section>
</div>
<div class="exercise admonition" id="head-data">

<p class="admonition-title"><span class="caption-number">Exercise 5.6 </span></p>
<section id="exercise-content">
<p>What is the purpose of the head() method in Pandas?</p>
<p>A.    To display the last few rows of a DataFrame</p>
<p>B.    To display the first few rows of a DataFrame</p>
<p>C.    To display summary statistics of a DataFrame</p>
<p>D.    To display maximums of a DataFrame</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-11">

<p class="admonition-title">Solution to<a class="reference internal" href="#head-data"> Exercise 5.6</a></p>
<section id="solution-content">
<p>B</p>
</section>
</div>
<div class="exercise admonition" id="shape">

<p class="admonition-title"><span class="caption-number">Exercise 5.7 </span></p>
<section id="exercise-content">
<p>What does the shape attribute of a DataFrame represent??</p>
<p>A.    Get the number of rows and columns</p>
<p>B.    Get the number of cells</p>
<p>C.    Get the data types of columns</p>
<p>D.    Get the number of rows</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-13">

<p class="admonition-title">Solution to<a class="reference internal" href="#shape"> Exercise 5.7</a></p>
<section id="solution-content">
<p>A</p>
</section>
</div>
<div class="exercise admonition" id="filter">

<p class="admonition-title"><span class="caption-number">Exercise 5.8 </span></p>
<section id="exercise-content">
<p>How can you filter rows in a DataFrame ‘df’ based on a condition ‘condition’?</p>
<p>A.    df.filter(condition)</p>
<p>B.    df[condition]</p>
<p>C.    df.filter_rows(condition)</p>
<p>D.    df.select_rows(condition)</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-15">

<p class="admonition-title">Solution to<a class="reference internal" href="#filter"> Exercise 5.8</a></p>
<section id="solution-content">
<p>B</p>
</section>
</div>
<div class="exercise admonition" id="drop">

<p class="admonition-title"><span class="caption-number">Exercise 5.9 </span></p>
<section id="exercise-content">
<p>How to drop a column ‘name’ from a DataFrame ‘df’ in Pandas?</p>
<p>A.    df.drop(‘name’, axis=1)</p>
<p>B.    df.drop(‘name’)</p>
<p>C.    df.remove(‘name’, axis=1)</p>
<p>D.    df.remove(‘name’)</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-17">

<p class="admonition-title">Solution to<a class="reference internal" href="#drop"> Exercise 5.9</a></p>
<section id="solution-content">
<p>A</p>
</section>
</div>
<div class="exercise admonition" id="describe">

<p class="admonition-title"><span class="caption-number">Exercise 5.10 </span></p>
<section id="exercise-content">
<p>What is the purpose of the describe() method in Pandas?</p>
<p>A.    To describe the data types of columns</p>
<p>B.    To provide information about missing values</p>
<p>C.    To provide the size of the data</p>
<p>D.    To display summary statistics of a DataFrame</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-19">

<p class="admonition-title">Solution to<a class="reference internal" href="#describe"> Exercise 5.10</a></p>
<section id="solution-content">
<p>D</p>
</section>
</div>
<div class="exercise admonition" id="merge">

<p class="admonition-title"><span class="caption-number">Exercise 5.11 </span></p>
<section id="exercise-content">
<p>How to merge two DataFrames based on a common column in Pandas?</p>
<p>A.    df.join()</p>
<p>B.    df.concate()</p>
<p>C.    df.combine()</p>
<p>D.    df.merge()</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-21">

<p class="admonition-title">Solution to<a class="reference internal" href="#merge"> Exercise 5.11</a></p>
<section id="solution-content">
<p>D</p>
</section>
</div>
<div class="exercise admonition" id="astype">

<p class="admonition-title"><span class="caption-number">Exercise 5.12 </span></p>
<section id="exercise-content">
<p>What does the astype() method in Pandas do?</p>
<p>A.    Converts a DataFrame to a NumPy array</p>
<p>B.    Converts data types of columns in a DataFrame</p>
<p>C.    Adds a new column to a DataFrame</p>
<p>D.    Removes duplicate values from a DataFrame</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-23">

<p class="admonition-title">Solution to<a class="reference internal" href="#astype"> Exercise 5.12</a></p>
<section id="solution-content">
<p>B</p>
</section>
</div>
<div class="exercise admonition" id="apply">

<p class="admonition-title"><span class="caption-number">Exercise 5.13 </span></p>
<section id="exercise-content">
<p>How to apply a custom function to each element in a Pandas DataFrame ‘df’?</p>
<p>A.    df.apply()</p>
<p>B.    df.map()</p>
<p>C.    df.modify()</p>
<p>D.    df.call()</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-25">

<p class="admonition-title">Solution to<a class="reference internal" href="#apply"> Exercise 5.13</a></p>
<section id="solution-content">
<p>A</p>
</section>
</div>
<div class="exercise admonition" id="reset_index">

<p class="admonition-title"><span class="caption-number">Exercise 5.14 </span></p>
<section id="exercise-content">
<p>How to reset the index of a Pandas DataFrame ‘df’?</p>
<p>A.    df.set_index()</p>
<p>B.    df.reset_index()</p>
<p>C.    df.index_set()</p>
<p>D.    df.index_reset()</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-27">

<p class="admonition-title">Solution to<a class="reference internal" href="#reset_index"> Exercise 5.14</a></p>
<section id="solution-content">
<p>B</p>
</section>
</div>
<div class="exercise admonition" id="duplicate">

<p class="admonition-title"><span class="caption-number">Exercise 5.15 </span></p>
<section id="exercise-content">
<p>How to remove duplicate values in a Pandas DataFrame ‘df’?</p>
<p>A.    df.delete_duplicate()</p>
<p>B.    df.eliminate_duplicate()</p>
<p>C.    df.remove_duplicate()</p>
<p>D.    df.drop_duplicate()</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-29">

<p class="admonition-title">Solution to<a class="reference internal" href="#duplicate"> Exercise 5.15</a></p>
<section id="solution-content">
<p>D</p>
</section>
</div>
<div class="exercise admonition" id="missing-value">

<p class="admonition-title"><span class="caption-number">Exercise 5.16 </span></p>
<section id="exercise-content">
<p>Which of the following method can handle missing values in a Pandas DataFrame ‘df’?</p>
<p>A.    df.fillna()</p>
<p>B.    df.dropna()</p>
<p>C.    Both A and B</p>
<p>D.    Neither A and B</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-31">

<p class="admonition-title">Solution to<a class="reference internal" href="#missing-value"> Exercise 5.16</a></p>
<section id="solution-content">
<p>C</p>
</section>
</div>
<div class="exercise admonition" id="save">

<p class="admonition-title"><span class="caption-number">Exercise 5.17 </span></p>
<section id="exercise-content">
<p>How to save a Pandas DataFrame ‘df’ to a CSV file ‘data.csv’?</p>
<p>A.    df.save_csv(‘data.csv’)</p>
<p>B.    df.to_csv(‘data.csv’)</p>
<p>C.    df.csv(‘data.csv’)</p>
<p>D.    df.export_csv(‘data.csv’)</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-33">

<p class="admonition-title">Solution to<a class="reference internal" href="#save"> Exercise 5.17</a></p>
<section id="solution-content">
<p>B</p>
</section>
</div>
<div class="exercise admonition" id="head10">

<p class="admonition-title"><span class="caption-number">Exercise 5.18 </span></p>
<section id="exercise-content">
<p>How to output the first 10 rows of a DataFrame ‘df’?</p>
<p>A.    df.top(20)</p>
<p>B.    df.tail(10)</p>
<p>C.    df.head(10)</p>
<p>D.    df.export(10)</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-35">

<p class="admonition-title">Solution to<a class="reference internal" href="#head10"> Exercise 5.18</a></p>
<section id="solution-content">
<p>C</p>
</section>
</div>
<div class="exercise admonition" id="inplace">

<p class="admonition-title"><span class="caption-number">Exercise 5.19 </span></p>
<section id="exercise-content">
<p>What argument to put insider the method ‘dropna()’ to make sure that the changes are done for the original DataFrame ‘df’?</p>
<p>A.    dropna(inplace=True)</p>
<p>B.    dropna(replace=True)</p>
<p>C.    dropna(fill=True)</p>
<p>D.    dropna(drop=True))</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-37">

<p class="admonition-title">Solution to<a class="reference internal" href="#inplace"> Exercise 5.19</a></p>
<section id="solution-content">
<p>A</p>
</section>
</div>
<div class="exercise admonition" id="to_datetime">

<p class="admonition-title"><span class="caption-number">Exercise 5.20 </span></p>
<section id="exercise-content">
<p>Which method for converting a column into Python’s date formats?</p>
<p>A.    date()</p>
<p>B.    datetime()</p>
<p>C.    to_date()</p>
<p>D.    to_datetime()</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-39">

<p class="admonition-title">Solution to<a class="reference internal" href="#to_datetime"> Exercise 5.20</a></p>
<section id="solution-content">
<p>D</p>
</section>
</div>
<div class="exercise admonition" id="pandas-read">

<p class="admonition-title"><span class="caption-number">Exercise 5.21 </span></p>
<section id="exercise-content">
<p>For the following panel data:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Student</p></th>
<th class="head"><p>Module1</p></th>
<th class="head"><p>Module2</p></th>
<th class="head"><p>Module3</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Stu1</p></td>
<td><p>50</p></td>
<td><p>45</p></td>
<td><p>56</p></td>
</tr>
<tr class="row-odd"><td><p>Stu2</p></td>
<td><p>81</p></td>
<td><p>76</p></td>
<td><p>73</p></td>
</tr>
<tr class="row-even"><td><p>Stu3</p></td>
<td><p>60</p></td>
<td><p>65</p></td>
<td><p>62</p></td>
</tr>
<tr class="row-odd"><td><p>Stu4</p></td>
<td><p>77</p></td>
<td><p>58</p></td>
<td><p>60</p></td>
</tr>
<tr class="row-even"><td><p>Stu5</p></td>
<td><p>60</p></td>
<td><p>59</p></td>
<td><p>54</p></td>
</tr>
<tr class="row-odd"><td><p>Stu6</p></td>
<td><p>40</p></td>
<td><p>55</p></td>
<td><p>53</p></td>
</tr>
<tr class="row-even"><td><p>Stu7</p></td>
<td><p>57</p></td>
<td><p>65</p></td>
<td><p>70</p></td>
</tr>
</tbody>
</table>
</div>
<p>Use Pandas to achieve the following:</p>
<ul class="simple">
<li><p>Put the above panel data to a Pandas DataFrame.</p></li>
<li><p>Drop the student row who has modul score less than 50 (&lt; 50).</p></li>
<li><p>Output the average score, maximum score of each module for the remnant students.</p></li>
<li><p>Rank the remnant students by the average score of all modules.</p></li>
<li><p>Output the final result to a csv file in the D drive named ‘output.csv’.</p></li>
</ul>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-41">

<p class="admonition-title">Solution to<a class="reference internal" href="#pandas-read"> Exercise 5.21</a></p>
<section id="solution-content">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Student&#39;</span><span class="p">,</span> <span class="s1">&#39;Module1&#39;</span><span class="p">,</span> <span class="s1">&#39;Module2&#39;</span><span class="p">,</span> <span class="s1">&#39;Module3&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s1">&#39;Stu1&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">56</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Stu2&#39;</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">73</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Stu3&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">62</span><span class="p">],</span>\
                 <span class="p">[</span><span class="s1">&#39;Stu4&#39;</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Stu5&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">54</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Stu6&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">53</span><span class="p">],</span>\
                 <span class="p">[</span><span class="s1">&#39;Stu7&#39;</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">70</span><span class="p">]])</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Module1&#39;</span><span class="p">,</span> <span class="s1">&#39;Module2&#39;</span><span class="p">,</span> <span class="s1">&#39;Module3&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Module1&#39;</span><span class="p">,</span> <span class="s1">&#39;Module2&#39;</span><span class="p">,</span> <span class="s1">&#39;Module3&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="c1"># question1</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Module1&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">50</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Module2&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">50</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Module3&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">50</span><span class="p">)]</span> <span class="c1"># question2</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Average score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Max score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># question3</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Average score&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># question4</span>
<span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;D:/output.csv&#39;</span><span class="p">)</span> <span class="c1"># question5</span>
</pre></div>
</div>
</section>
</div>
<script src="https://giscus.app/client.js"
        data-repo="robinchen121/book-Python-Data-Science"
        data-repo-id="R_kgDOKFdyOw"
        data-category="Announcements"
        data-category-id="DIC_kwDOKFdyO84CgWHi"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script><!-- Toogle google translation -->
<div id="google_translate_element"></div>
<script type="text/javascript">
      function googleTranslateElementInit() {
        new google.translate.TranslateElement({ pageLanguage: 'en',
                  includedLanguages: 'zh-CN,zh-TW,en,ja,ko,de,ru,fr,es,it,pt,hi,ar,fa',
layout: google.translate.TranslateElement.InlineLayout.SIMPLE }, 'google_translate_element');
      }
</script>
<script type="text/javascript"
      src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"
></script>
<br><script src="https://giscus.app/client.js"
        data-repo="robinchen121/book-Python-Data-Science"
        data-repo-id="R_kgDOKFdyOw"
        data-category="Announcements"
        data-category-id="DIC_kwDOKFdyO84CgWHi"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script><hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>* means this section may not be delivered in class.</p>
</aside>
</aside>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "RobinChen121/book-Python-Data-Science-en",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "conda-base-py"
        },
        kernelOptions: {
            name: "conda-base-py",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'conda-base-py'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="introduction-to-numpy.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Introduction to Numpy</p>
      </div>
    </a>
    <a class="right-next"
       href="define-function.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Functions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-reading-and-storing-data">5.1. Creating, Reading, and Storing Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-data">5.1.1. Creating Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-data">5.1.2. Reading Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#store-the-data">5.1.3. Store the data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#access-and-change-data">5.2. Access and change data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-the-data-of-a-single-row-column-or-cell">5.2.1. Access the data of a single row, column or cell</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#acess-multi-row-or-multi-column-data">5.2.2. Acess multi-row or multi-column data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#view-the-statistical-values-of-the-data">5.2.3. View the statistical values of the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#revise-data">5.2.4. Revise data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning">5.3. Data cleaning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-replacement-replace-fillna">5.3.1. Data replacement <code class="docutils literal notranslate"><span class="pre">replace</span></code>, <code class="docutils literal notranslate"><span class="pre">fillna</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cast-the-data-type-astype">5.3.2. Cast the data type <code class="docutils literal notranslate"><span class="pre">astype</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-duplicates-drop-duplicates">5.3.3. Remove duplicates <code class="docutils literal notranslate"><span class="pre">drop_duplicates</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-missing-valuesdropna">5.3.4. Remove missing values<code class="docutils literal notranslate"><span class="pre">dropna</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rename-rename">5.3.5. Rename <code class="docutils literal notranslate"><span class="pre">rename</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-delete-and-merge-data">5.4. Add, delete and merge data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-data">5.4.1. Add data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#delete-data">5.4.2. Delete data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-data">5.4.3. Merge data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-sort-and-group-the-data">5.5. Filter, sort and group the data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-data">5.5.1. Filter data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sort-data">5.5.2. Sort data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#group-the-data-groupby">5.5.3. Group the data <code class="docutils literal notranslate"><span class="pre">groupby</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#method-reset-index-or-argument-as-index-false">5.5.4. Method <code class="docutils literal notranslate"><span class="pre">reset_index()</span></code> or argument <code class="docutils literal notranslate"><span class="pre">as_index=False</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#output-data-to-a-numpy-array-or-a-list">5.6. Output data to a NumPy array or a list</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apply-a-function-method">5.7. Apply a function/method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#process-time-series-data">5.8. Process time-series data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#to-datetime-and-dt-strftime">5.8.1. <code class="docutils literal notranslate"><span class="pre">to_datetime</span></code> and <code class="docutils literal notranslate"><span class="pre">dt.strftime</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-aggregation-resample-1">5.8.2. Data aggregation <code class="docutils literal notranslate"><span class="pre">resample</span></code>* </a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-draw-picutres">5.9. Pandas draw picutres*</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">5.10. Exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Zhen Chen
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>