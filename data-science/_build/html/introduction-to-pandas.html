
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5. Introduction to Pandas &#8212; Python 数据科学</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css?v=982b99e0" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/myfile.css?v=bfa9aaae" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'introduction-to-pandas';</script>
    <script src="_static/myfile.js?v=78ba3122"></script>
    <script src="_static/.ipynb_checkpoints/myfile-checkpoint.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6. Define functions" href="define-function.html" />
    <link rel="prev" title="4. Introduction to Numpy" href="introduction-to-numpy.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Python 数据科学 - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Python 数据科学 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Preface
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Python Basics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="A-first-look-of-Python.html">1. Getting started with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic-data-type.html">2. Data types in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="print-read-files.html">3. Output, read and write files</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction-to-numpy.html">4. Introduction to Numpy</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">5. Introduction to Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="define-function.html">6. Define functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="draw-pictures.html">7. Python 画图</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python Advanced</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="line-regression.html">8. 统计分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction-to-crawler.html">9. 爬虫入门</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction-to-class.html">10. Python 面向对象编程</a></li>
<li class="toctree-l1"><a class="reference internal" href="good-practices-python.html">11. Python 的良好编程规范</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction-to-parallel.html">12. Python 并行计算</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/RobinChen121/book-Python-Data-Science-en/main?urlpath=lab/tree/data-science-en/introduction-to-pandas.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/RobinChen121/book-Python-Data-Science-en" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/RobinChen121/book-Python-Data-Science-en/issues/new?title=Issue%20on%20page%20%2Fintroduction-to-pandas.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/introduction-to-pandas.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Introduction to Pandas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-reading-and-storing-data">5.1. Creating, Reading, and Storing Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-data">5.1.1. Creating Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-data">5.1.2. Reading Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#store-the-data">5.1.3. Store the data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#access-and-change-data">5.2. Access and change data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-the-data-of-a-single-row-column-or-cell">5.2.1. Access the data of a single row, column or cell</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#acess-multi-row-or-multi-column-data">5.2.2. Acess multi-row or multi-column data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#view-the-statistical-values-of-the-data">5.2.3. View the statistical values of the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#revise-data">5.2.4. Revise data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-delete-and-merge-data">5.3. Add, delete and merge data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-data">5.3.1. Add data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#delete-data">5.3.2. Delete data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-data">5.3.3. Merge data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#search-sort-and-group-the-data">5.4. Search, sort and group the data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#search-data">5.4.1. Search data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sort-data">5.4.2. Sort data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#group-the-data-groupby">5.4.3. Group the data <code class="docutils literal notranslate"><span class="pre">groupby</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#method-reset-index-or-parameter-as-index-false">5.4.4. Method <code class="docutils literal notranslate"><span class="pre">reset_index()</span></code> or parameter <code class="docutils literal notranslate"><span class="pre">as_index=False</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#to-a-numpy-array-or-a-list">5.5. To a NumPy array or a list</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apply-a-method">5.6. Apply a method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">5.7. 数据清洗</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#replace-fillna">5.7.1. 数据替换<code class="docutils literal notranslate"><span class="pre">replace</span></code>, <code class="docutils literal notranslate"><span class="pre">fillna</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astype">5.7.2. 数据类型转换 <code class="docutils literal notranslate"><span class="pre">astype</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#drop-duplicates">5.7.3. 重复值处理<code class="docutils literal notranslate"><span class="pre">drop_duplicates</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#drop-na">5.7.4. 缺失值处理<code class="docutils literal notranslate"><span class="pre">drop_na</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rename">5.7.5. 重命名<code class="docutils literal notranslate"><span class="pre">rename</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">5.8. 时间序列数据处理</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#to-datetime-dt-strftime">5.8.1. <code class="docutils literal notranslate"><span class="pre">to_datetime</span></code> 与 <code class="docutils literal notranslate"><span class="pre">dt.strftime</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resample">5.8.2. 数据聚合函数<code class="docutils literal notranslate"><span class="pre">resample</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-draw-picutres-1">5.9. Pandas draw picutres*</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">5.10. Exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="introduction-to-pandas">
<h1><span class="section-number">5. </span>Introduction to Pandas<a class="headerlink" href="#introduction-to-pandas" title="Link to this heading">#</a></h1>
<hr>
<p><code class="docutils literal notranslate"><span class="pre">Pandas</span></code> is one of the most important data analysis tools in Python for data processing. Built on NumPy, it offers many methods for handling large datasets and allows flexible, efficient data manipulation.</p>
<p>The main data type used in pandas is the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, which is a two-dimensional structure similar to a table in Excel. To use pandas, you first need to import it. In fact, the name ‘Pandas’ is short for ‘panel data’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<section id="creating-reading-and-storing-data">
<h2><span class="section-number">5.1. </span>Creating, Reading, and Storing Data<a class="headerlink" href="#creating-reading-and-storing-data" title="Link to this heading">#</a></h2>
<hr>
<section id="creating-data">
<h3><span class="section-number">5.1.1. </span>Creating Data<a class="headerlink" href="#creating-data" title="Link to this heading">#</a></h3>
<hr>
<p>For example, consider the following data:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Name</p></th>
<th class="head text-center"><p>Statistics</p></th>
<th class="head text-center"><p>Accounting</p></th>
<th class="head text-center"><p>Makerting</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Jim</p></td>
<td class="text-center"><p>85</p></td>
<td class="text-center"><p>82</p></td>
<td class="text-center"><p>84</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Lily</p></td>
<td class="text-center"><p>68</p></td>
<td class="text-center"><p>63</p></td>
<td class="text-center"><p>90</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Jack</p></td>
<td class="text-center"><p>90</p></td>
<td class="text-center"><p>88</p></td>
<td class="text-center"><p>78</p></td>
</tr>
</tbody>
</table>
</div>
<p>In general, there are two ways to create a DataFrame.</p>
<ul class="simple">
<li><p>Create the DataFrame by dictionaries <code class="docutils literal notranslate"><span class="pre">dict</span></code>.</p></li>
<li><p>Create the DataFrame by an <code class="docutils literal notranslate"><span class="pre">NumPy</span> <span class="pre">ndarray</span></code> and a parameter <code class="docutils literal notranslate"><span class="pre">columns</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;Jack&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
        <span class="s2">&quot;Accounting&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">82</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span>
        <span class="s2">&quot;Marketing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">78</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Name  Statistics  Accounting  Marketing
0   Jim          85          82         84
1  Lily          68          63         90
2  Jack          90          88         78
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">84</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;Jack&quot;</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">78</span><span class="p">]])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Accounting&quot;</span><span class="p">,</span> <span class="s2">&quot;Marketing&quot;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Accounting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    82.0
1    63.0
2    88.0
Name: Accounting, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>In the above outputs, the first row are column lables while the first column are row indices. We can visit them by <code class="docutils literal notranslate"><span class="pre">columns</span></code> and <code class="docutils literal notranslate"><span class="pre">index</span></code>, respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Name&#39;, &#39;Statistics&#39;, &#39;Accounting&#39;, &#39;Marketing&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RangeIndex(start=0, stop=3, step=1)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>One column data of a DataFrame is called a <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Statistics&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.series.Series
</pre></div>
</div>
</div>
</div>
<p>Pandas also supports converting one-dimensional or two-dimensional arrays/lists directly into DataFrame format.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="reading-data">
<h3><span class="section-number">5.1.2. </span>Reading Data<a class="headerlink" href="#reading-data" title="Link to this heading">#</a></h3>
<hr>
<p>In most cases, we need to read data files (such as Excel files). Suppose the example above is saved in an Excel file named ‘transcripts.xlsx’ located in the “datas/” directory on your computer. We can read the file using the <code class="docutils literal notranslate"><span class="pre">read_excel</span></code> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;datas/transcripts.xlsx&quot;</span><span class="p">)</span>
<span class="c1"># or df = pd.read_excel(&quot;datas\\transcripts.xlsx&quot;)</span>
<span class="c1"># or df = pd.read_excel(r&quot;datas\transcripts.xlsx&quot;)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>File paths on macOS use the forward slash <code class="docutils literal notranslate"><span class="pre">/</span></code> as a separator, while Windows uses the backslash <code class="docutils literal notranslate"><span class="pre">\</span></code>.</p></li>
<li><p>Adding an <code class="docutils literal notranslate"><span class="pre">r</span></code> before a file path string (e.g., r”path”) preserves the original meaning of the string and prevents special characters from being escaped.</p></li>
</ul>
</div>
<p>The syntax for <code class="docutils literal notranslate"><span class="pre">read_excel</span></code>is:</p>
<table>   
    <tr style="border-top:solid; border-bottom:solid">
        <th colspan=2 style="text-align:center">
            read_excel(io, sheetname=0, header=0, skiprows=None, index_col=None, encoding=None)
        </th>
    </tr>
    <tr>
        <td style="text-align:left">io</td>
        <td style="text-align:left">The file path and name of the data file, usually provided as a string.</td>
    </tr>
    <tr>
        <td style="text-align:left">sheetname</td>
        <td style="text-align:left">The name or index of the worksheet. Defaults to 0, which reads the first sheet.</td>
    </tr>
    <tr>
        <td style="text-align:left">header</td>
        <td style="text-align:left">The row to use as column names. Defaults to 0, meaning the first row is used as headers.</td>
    </tr>
    <tr>
        <td style="text-align:left">skiprows</td>
        <td style="text-align:left">Number of rows to skip from the top of the file.</td>
    </tr>
    <tr>
        <td style="text-align:left">index_col</td>
        <td style="text-align:left">Column to use as the row labels of the DataFrame.</td>
    </tr>
    <tr style="border-bottom:solid">
        <td style="text-align:left">encoding</td>
        <td style="text-align:left">Encoding format, commonly 'gbk' or 'utf-8'.</td>
    </tr>
</table><div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>When reading certain data files, you may need to add the decoding parameter <code class="docutils literal notranslate"><span class="pre">encoding='gbk'</span></code> or <code class="docutils literal notranslate"><span class="pre">encoding='utf-8'</span></code> for proper reading.</p></li>
</ul>
</div>
<p>Another common data file format is CSV. We can simply use Pandas’ <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> method, whose syntax is essentially the same as <code class="docutils literal notranslate"><span class="pre">read_excel</span></code>.</p>
</section>
<section id="store-the-data">
<h3><span class="section-number">5.1.3. </span>Store the data<a class="headerlink" href="#store-the-data" title="Link to this heading">#</a></h3>
<hr>
<p>To save data, use the <code class="docutils literal notranslate"><span class="pre">to_excel</span></code> or <code class="docutils literal notranslate"><span class="pre">to_csv</span></code> method. For example, to save our DataFrame df to the “datas/” folder with the filename “marks.xlsx”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&quot;datas/marks.xlsx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>The folder must first exists in the computer before using <code class="docutils literal notranslate"><span class="pre">to_excel</span></code> or <code class="docutils literal notranslate"><span class="pre">to_csv</span></code>.</p></li>
<li><p>By default, the row indeices are not written to the file. If you want to include the index in the saved file, you can set <code class="docutils literal notranslate"><span class="pre">index=True</span></code> (the default is index=False).</p></li>
</ul>
</section>
</section>
<section id="access-and-change-data">
<h2><span class="section-number">5.2. </span>Access and change data<a class="headerlink" href="#access-and-change-data" title="Link to this heading">#</a></h2>
<hr>
<p>To quickly view the statistical summary of each column in a DataFrame, you can use the <code class="docutils literal notranslate"><span class="pre">describe()</span></code> method. It includes information such as the number of non-null values, mean, standard deviation, minimum, maximum, and quartiles for each column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>top</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Additionally, there are several useful method:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">info()</span></code></p></td>
<td><p>View the data type of each column</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">head()</span></code></p></td>
<td><p>View the first 5 rows of the data</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tail()</span></code></p></td>
<td><p>View the last 5 rows of the data</p></td>
</tr>
</tbody>
</table>
</div>
<section id="access-the-data-of-a-single-row-column-or-cell">
<h3><span class="section-number">5.2.1. </span>Access the data of a single row, column or cell<a class="headerlink" href="#access-the-data-of-a-single-row-column-or-cell" title="Link to this heading">#</a></h3>
<hr>
<p>The simplest way to view a specific column of data is by entering the column name within square brackets <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code>. For example, to view the ‘Marketing’ scores column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Marketing&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    84
1    90
2    78
Name: Marketing, dtype: object
</pre></div>
</div>
</div>
</div>
<p>To view a particular row of data, use the <code class="docutils literal notranslate"><span class="pre">loc[</span> <span class="pre">]</span></code> method with the row index.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># show the data of the first row</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Name          Jim
Statistics     85
Accounting     82
Marketing      84
Name: 0, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># show the data of the 3rd row</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Name          Jack
Statistics      90
Accounting      88
Marketing       78
Name: 2, dtype: object
</pre></div>
</div>
</div>
</div>
<p>To view a specific cell, a convenient method is to use double square brackets <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">][</span> <span class="pre">]</span></code>, with the column label and row index inside each bracket respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Marketing&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;90&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="acess-multi-row-or-multi-column-data">
<h3><span class="section-number">5.2.2. </span>Acess multi-row or multi-column data<a class="headerlink" href="#acess-multi-row-or-multi-column-data" title="Link to this heading">#</a></h3>
<hr>
<p>To view multiple rows and columns of data, you can use <code class="docutils literal notranslate"><span class="pre">iloc[</span> <span class="pre">]</span></code>, which not only allows accessing multiple rows and columns but also supports retrieving single rows, single columns, or even individual cell data.。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># view the data in the 2nd row</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Name          Lily
Statistics      68
Accounting      63
Marketing       90
Name: 1, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># view the data of the first 2 rows</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>  <span class="c1"># view the data of the 1st and the 3rd rows</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>View the column data with <code class="docutils literal notranslate"><span class="pre">[:,</span> <span class="pre">]</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># view the data of the 2nd column</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    85
1    68
2    90
Name: Statistics, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># view the data of the first 2 columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>  <span class="c1"># view the data of the 1st and 3rd columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Accounting</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>82</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>63</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>88</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>View the data in a block.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># view the data in the first 2 rows and the first 2 columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>  <span class="c1"># view the data in row 1 and 3, column 1 and 3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Accounting</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>82</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>88</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># view the data in row 1 and 3, column 1 and 2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>View the data in some cell.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># view the data in the cell of row 1 and column 1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;68&#39;
</pre></div>
</div>
</div>
</div>
<p>To view specific columns of data, in addition to using <code class="docutils literal notranslate"><span class="pre">iloc</span></code>, you can <strong>directly pass a list of column labels inside square brackets <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code></strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Marketing&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>85</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>68</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>90</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>It is same as the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>85</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>68</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>90</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="view-the-statistical-values-of-the-data">
<h3><span class="section-number">5.2.3. </span>View the statistical values of the data<a class="headerlink" href="#view-the-statistical-values-of-the-data" title="Link to this heading">#</a></h3>
<hr>
<p>Pandas provides built-in statistical method to calculate summary statistics for column data. These method include: <code class="docutils literal notranslate"><span class="pre">mean()</span></code> (average), <code class="docutils literal notranslate"><span class="pre">max()</span></code> (maximum), <code class="docutils literal notranslate"><span class="pre">min()</span></code> (minimum), <code class="docutils literal notranslate"><span class="pre">median()</span></code>, <code class="docutils literal notranslate"><span class="pre">std()</span></code> (standard deviation), <code class="docutils literal notranslate"><span class="pre">count()</span></code>, <code class="docutils literal notranslate"><span class="pre">skew()</span></code> (skewness), <code class="docutils literal notranslate"><span class="pre">quantile()</span></code>, and more. In some cases, you may need to specify the parameter <code class="docutils literal notranslate"><span class="pre">numeric_only=True</span></code> to ensure the method is only applied to numeric columns.</p>
<ul class="simple">
<li><p>Sometimes we may need to cast the data types to numeric before using those methods.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Statistics&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;str&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Statistics&#39;</span><span class="p">,</span> <span class="s1">&#39;Accounting&#39;</span><span class="p">,</span> <span class="s1">&#39;Marketing&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Statistics&#39;</span><span class="p">,</span> <span class="s1">&#39;Accounting&#39;</span><span class="p">,</span> <span class="s1">&#39;Marketing&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85.0</td>
      <td>82.0</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68.0</td>
      <td>63.0</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90.0</td>
      <td>88.0</td>
      <td>78.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>81.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to calculate the average score for each course</span>
<span class="c1"># since the first column (&#39;names&#39;) is non-numeric, the parameter numeric_only=True is added.`</span>
<span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Statistics    81.000000
Accounting    77.666667
Marketing     84.000000
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Accounting&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>88.0
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Using ‘axis=1’ to apply the function to rows</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># computer the average score of each student</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    83.666667
1    73.666667
2    85.333333
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="revise-data">
<h3><span class="section-number">5.2.4. </span>Revise data<a class="headerlink" href="#revise-data" title="Link to this heading">#</a></h3>
<hr>
<p>When modifying data in a pandas DataFrame, you can assign new values based on pandas index positions: <strong>either assigning a column/row to a single value or to a list with equal length</strong>, using <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code> and <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code>, respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Accounting&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">80</span>  <span class="c1"># revise all the accounting scores to 80</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85.0</td>
      <td>80</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68.0</td>
      <td>80</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90.0</td>
      <td>80</td>
      <td>78.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Accounting&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">88</span><span class="p">]</span>  <span class="c1"># revise the accounting scores to be the list values</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85.0</td>
      <td>64</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68.0</td>
      <td>76</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90.0</td>
      <td>88</td>
      <td>78.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">80</span>  <span class="c1"># revise all the values in row 2 to 80</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85.0</td>
      <td>64</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>80</td>
      <td>80.0</td>
      <td>80</td>
      <td>80.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90.0</td>
      <td>88</td>
      <td>78.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Ella&quot;</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">89</span><span class="p">]</span>  <span class="c1"># revise all the values in row 2 to the list values</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85.0</td>
      <td>64</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ella</td>
      <td>95.0</td>
      <td>90</td>
      <td>89.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90.0</td>
      <td>88</td>
      <td>78.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Revise the value in some cell:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">55</span>  
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85.0</td>
      <td>64</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ella</td>
      <td>55.0</td>
      <td>90</td>
      <td>89.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90.0</td>
      <td>88</td>
      <td>78.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To change the data type of column, using method <code class="docutils literal notranslate"><span class="pre">astype()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Marketing&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    84.0
1    89.0
2    78.0
Name: Marketing, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="add-delete-and-merge-data">
<h2><span class="section-number">5.3. </span>Add, delete and merge data<a class="headerlink" href="#add-delete-and-merge-data" title="Link to this heading">#</a></h2>
<hr><section id="add-data">
<h3><span class="section-number">5.3.1. </span>Add data<a class="headerlink" href="#add-data" title="Link to this heading">#</a></h3>
<hr>
<p>To add a new column at the end of the original data, the syntax is similar to revising the data, using <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code> and <code class="docutils literal notranslate"><span class="pre">.loc[</span> <span class="pre">]</span></code> for adding columns or rows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Python Programming&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">60</span> <span class="c1"># add one column of data in which all the values equal a single value</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python Programming</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85.0</td>
      <td>64</td>
      <td>84.0</td>
      <td>60</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ella</td>
      <td>55.0</td>
      <td>90</td>
      <td>89.0</td>
      <td>60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90.0</td>
      <td>88</td>
      <td>78.0</td>
      <td>60</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Financing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">70</span><span class="p">]</span> <span class="c1"># add one column of data in which the values equal to a list</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python Programming</th>
      <th>Financing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85.0</td>
      <td>64</td>
      <td>84.0</td>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ella</td>
      <td>55.0</td>
      <td>90</td>
      <td>89.0</td>
      <td>60</td>
      <td>50</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90.0</td>
      <td>88</td>
      <td>78.0</td>
      <td>60</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To add a new row at the end of the original data, using <code class="docutils literal notranslate"><span class="pre">.loc[</span> <span class="pre">]</span></code>.</p>
<ul class="simple">
<li><p>not <code class="docutils literal notranslate"><span class="pre">.iloc[</span> <span class="pre">]</span></code>, which can’t enlarge the DataFrame.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">3</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;David&quot;</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">83</span><span class="p">]</span> 
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python Programming</th>
      <th>Financing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85.0</td>
      <td>64.0</td>
      <td>84.0</td>
      <td>60.0</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ella</td>
      <td>55.0</td>
      <td>90.0</td>
      <td>89.0</td>
      <td>60.0</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90.0</td>
      <td>88.0</td>
      <td>78.0</td>
      <td>60.0</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>David</td>
      <td>65.0</td>
      <td>70.0</td>
      <td>69.0</td>
      <td>55.0</td>
      <td>83.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If inserting a column to specific index, using the method <code class="docutils literal notranslate"><span class="pre">insert</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Economy&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">61</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">81</span><span class="p">])</span>  <span class="c1"># insert a new column at column index 1</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Economy</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python Programming</th>
      <th>Financing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>61</td>
      <td>85.0</td>
      <td>64.0</td>
      <td>84.0</td>
      <td>60.0</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ella</td>
      <td>72</td>
      <td>55.0</td>
      <td>90.0</td>
      <td>89.0</td>
      <td>60.0</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>84</td>
      <td>90.0</td>
      <td>88.0</td>
      <td>78.0</td>
      <td>60.0</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>David</td>
      <td>81</td>
      <td>65.0</td>
      <td>70.0</td>
      <td>69.0</td>
      <td>55.0</td>
      <td>83.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To insert rows at a specific position, Pandas currently does not have a dedicated method for this operation. The common approach is to use the <code class="docutils literal notranslate"><span class="pre">concat()</span></code> method to combine multiple DataFrames. Additionally, both <code class="docutils literal notranslate"><span class="pre">concat()</span></code> and <code class="docutils literal notranslate"><span class="pre">merge()</span></code> can be used to add multiple columns or rows. For detailed usage, please refer to the “Merge Data” section later in this documentation.</p>
</section>
<section id="delete-data">
<h3><span class="section-number">5.3.2. </span>Delete data<a class="headerlink" href="#delete-data" title="Link to this heading">#</a></h3>
<hr><p>Pandas can use the <code class="docutils literal notranslate"><span class="pre">drop()</span></code> method to remove rows or columns. <strong>To delete a row, specify the row index as the parameter along with <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code></strong>. If the <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> parameter is omitted, the original DataFrame remains unchanged.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># delete the 3rd row</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Economy</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python Programming</th>
      <th>Financing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>61</td>
      <td>85.0</td>
      <td>64.0</td>
      <td>84.0</td>
      <td>60.0</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ella</td>
      <td>72</td>
      <td>55.0</td>
      <td>90.0</td>
      <td>89.0</td>
      <td>60.0</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>84</td>
      <td>90.0</td>
      <td>88.0</td>
      <td>78.0</td>
      <td>60.0</td>
      <td>70.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>To delete a row, using <code class="docutils literal notranslate"><span class="pre">drop()</span> </code> with an additional parameter <code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">=</span> <span class="pre">1</span></code>**</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Python Programming&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Economy</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Financing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>61</td>
      <td>85.0</td>
      <td>64.0</td>
      <td>84.0</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ella</td>
      <td>72</td>
      <td>55.0</td>
      <td>90.0</td>
      <td>89.0</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>84</td>
      <td>90.0</td>
      <td>88.0</td>
      <td>78.0</td>
      <td>70.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>To delete multi rows or columns, using <code class="docutils literal notranslate"><span class="pre">drop()</span></code> with the indices or lables in a list.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;Marketing&quot;</span><span class="p">,</span> <span class="s2">&quot;Financing&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># delete two columns</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Economy</th>
      <th>Statistics</th>
      <th>Accounting</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>61</td>
      <td>85.0</td>
      <td>64.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ella</td>
      <td>72</td>
      <td>55.0</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>84</td>
      <td>90.0</td>
      <td>88.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># delete two rows</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Economy</th>
      <th>Statistics</th>
      <th>Accounting</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Ella</td>
      <td>72</td>
      <td>55.0</td>
      <td>90.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">drop()</span></code> method can drop data with conditions. For example:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;Jack&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
        <span class="s2">&quot;Accounting&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">82</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span>
        <span class="s2">&quot;Marketing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">78</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">70</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># delete the rows in which the statistics score is higher than 70</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Using <code class="docutils literal notranslate"><span class="pre">reset_index(drop=True)</span></code> to reset the row indices and drop the original indices</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="merge-data">
<h3><span class="section-number">5.3.3. </span>Merge data<a class="headerlink" href="#merge-data" title="Link to this heading">#</a></h3>
<hr>
<p>In Pandas, two commonly used method for combining datasets are concat and merge.</p>
<ul class="simple">
<li><p>Use concat when the two DataFrames have identical column labels.</p></li>
<li><p>In other cases, merge is typically preferred.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;Jack&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
        <span class="s2">&quot;Accounting&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">82</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span>
        <span class="s2">&quot;Marketing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">78</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;David&quot;</span><span class="p">,</span> <span class="s2">&quot;Ella&quot;</span><span class="p">],</span> <span class="s2">&quot;Statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">83</span><span class="p">,</span> <span class="mi">59</span><span class="p">],</span> <span class="s2">&quot;Accounting&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">62</span><span class="p">,</span> <span class="mi">70</span><span class="p">],</span> <span class="s2">&quot;Marketing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">78</span><span class="p">]}</span>
<span class="p">)</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>David</td>
      <td>83</td>
      <td>62</td>
      <td>64</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ella</td>
      <td>59</td>
      <td>70</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Since the two DataFrames have same column lables, using <code class="docutils literal notranslate"><span class="pre">concat([</span> <span class="pre">])</span></code>and put the two DataFrames <strong>in a list</strong> to merge.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">])</span>  <span class="c1">#  there are square brackets [ ]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
    <tr>
      <th>0</th>
      <td>David</td>
      <td>83</td>
      <td>62</td>
      <td>64</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ella</td>
      <td>59</td>
      <td>70</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To rename the indexes after merging, you can add the parameter <code class="docutils literal notranslate"><span class="pre">ignore_index=True</span></code>, which will reassign sequential numeric indexes starting from 0 to the merged data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
    <tr>
      <th>3</th>
      <td>David</td>
      <td>83</td>
      <td>62</td>
      <td>64</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ella</td>
      <td>59</td>
      <td>70</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>concat 默认按行合并，若按列合并，可以在小括号内添加参数<code class="docutils literal notranslate"><span class="pre">axis=1</span></code></p></li>
</ul>
<p>假如有下面的数据：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;Jack&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Python&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">65</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span>
        <span class="s2">&quot;Business Modelling&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">72</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">78</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Python</th>
      <th>Business Modelling</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>65</td>
      <td>72</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>60</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>When df1 and df3 share the same ‘Name’ column but have different other column names, and we want to add df3’s columns to df1, we should use the <code class="docutils literal notranslate"><span class="pre">merge()</span></code> method. The typical syntax is as follows:</p>
<table>
    <tr style="border-top:solid; border-bottom:solid">
        <th colspan=2 style="text-align:center">DataFrame.merge(right, how='inner', on=None)</th>
    </tr>
    <tr>
        <td style="text-align:left">right</td>
        <td style="text-align:left">The other DataFrame to merge;</td>
    </tr>
    <tr>
        <td rowspan=4 style="text-align:left">how</td>
        <td style="text-align:left">Default 'inner': performs inner join, merging only matching keys from both DataFrames</td>
    </tr>
    <tr>
        <td style="text-align:left">'outer': performs full outer join, merging all keys from both DataFrames</td>
    </tr>
    <tr>
        <td style="text-align:left">'left': performs left join, preserving all keys from the left DataFrame</td>
    </tr>
    <tr>
        <td style="text-align:left">'right': performs right join, preserving all keys from the right DataFrame</td>
    </tr>
    <tr style="border-bottom:solid">
        <td style="text-align:left">on</td>
        <td style="text-align:left">Column labels to join on (single or multiple)</td>
    </tr>
</table><p>So, for df1 and df3, when using <code class="docutils literal notranslate"><span class="pre">merge</span></code>, the matching key is ‘Name’:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df3</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python</th>
      <th>Business Modelling</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
      <td>65</td>
      <td>72</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
      <td>68</td>
      <td>63</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
      <td>60</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>When merging DataFrames, Pandas will automatically fill missing values with NaN for non-matching fields. The following example demonstrates the results of different join method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;Robert&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Python&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">65</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span>
        <span class="s2">&quot;Business Modelling&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">68</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">df4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Python</th>
      <th>Business Modelling</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>65</td>
      <td>72</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>78</td>
      <td>73</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Robert</td>
      <td>60</td>
      <td>68</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df4</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python</th>
      <th>Business Modelling</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
      <td>65</td>
      <td>72</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
      <td>78</td>
      <td>73</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df4</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python</th>
      <th>Business Modelling</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jack</td>
      <td>90.0</td>
      <td>88.0</td>
      <td>78.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jim</td>
      <td>85.0</td>
      <td>82.0</td>
      <td>84.0</td>
      <td>65.0</td>
      <td>72.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lily</td>
      <td>68.0</td>
      <td>63.0</td>
      <td>90.0</td>
      <td>78.0</td>
      <td>73.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robert</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>60.0</td>
      <td>68.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df4</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python</th>
      <th>Business Modelling</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
      <td>65.0</td>
      <td>72.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
      <td>78.0</td>
      <td>73.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df4</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
      <th>Python</th>
      <th>Business Modelling</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85.0</td>
      <td>82.0</td>
      <td>84.0</td>
      <td>65</td>
      <td>72</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68.0</td>
      <td>63.0</td>
      <td>90.0</td>
      <td>78</td>
      <td>73</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Robert</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>60</td>
      <td>68</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="search-sort-and-group-the-data">
<h2><span class="section-number">5.4. </span>Search, sort and group the data<a class="headerlink" href="#search-sort-and-group-the-data" title="Link to this heading">#</a></h2>
<hr>
<section id="search-data">
<h3><span class="section-number">5.4.1. </span>Search data<a class="headerlink" href="#search-data" title="Link to this heading">#</a></h3>
<hr>
<p>When querying DataFrame data based on certain conditions, some comparison operators are commonly used, such as: <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">==</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">!=</span></code>. Conditional queries are generally applied only to column data. During the query process, <strong>Pandas first generates a Boolean index (True or False)</strong> and then produces the queried data by specifying this index.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Jim&quot;</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;Jack&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
        <span class="s2">&quot;Accounting&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">82</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span>
        <span class="s2">&quot;Marketing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">78</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">70</span>  <span class="c1">#  get the boolean index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     True
1    False
2     True
Name: Statistics, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">70</span><span class="p">]</span>  <span class="c1"># get the conditional data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>For multi-condition queries, you can use <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> to represent <strong>AND</strong> (both conditions must be satisfied) and <code class="docutils literal notranslate"><span class="pre">|</span></code> to represent <strong>OR</strong> (either condition can be satisfied). And, <strong>each condition is in the paratheses <code class="docutils literal notranslate"><span class="pre">(</span> <span class="pre">)</span></code></strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">70</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Marketing&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">80</span><span class="p">)]</span>  <span class="c1"># get the data where statistics score is greater than 70, and marketing score is greater than 80</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">70</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Marketing&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">80</span><span class="p">)]</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="sort-data">
<h3><span class="section-number">5.4.2. </span>Sort data<a class="headerlink" href="#sort-data" title="Link to this heading">#</a></h3>
<hr>
<p>When working with data, sorting is often necessary. Pandas provides a convenient method called <code class="docutils literal notranslate"><span class="pre">sort_values</span></code> for sorting numerical data. Its syntax is as follows:</p>
<table>
     <tr style="border-top:solid; border-bottom:solid">
            <th colspan=2 style="text-align:center">DataFrame.sort_values(by, axis=0, ascending=True, inplace=False,  na_position='last', ignore_index=False)</th>
    </tr>
    <tr>
        <td style="text-align:left">by</td>
        <td style="text-align:left">Column labels to sort by (axis=0) or row indices (axis=1); multiple values allowed</td>
    </tr>
    <tr>
        <td style="text-align:left">axis</td>
        <td style="text-align:left">0 for column-wise sorting, 1 for row-wise sorting (default: 0)</td>
    </tr>
    <tr>
        <td style="text-align:left">ascending</td>
        <td style="text-align:left">Sort order: True for ascending, False for descending (default: True)</td>
    </tr>
    <tr>
        <td style="text-align:left">inplace</td>
        <td style="text-align:left">Whether to modify the DataFrame in place (default: False)</td>
    </tr>
    <tr>
        <td style="text-align:left">na_position</td>
        <td style="text-align:left">Position for missing values: 'first' or 'last' (default: 'last')</td>
    </tr>
    <tr style="border-bottom:solid">
        <td style="text-align:left">ignore_index</td>
        <td style="text-align:left">If True, the resulting axis will be labeled 0, 1, ..., n-1 (default: False)</td>
    </tr>
</table>
<br><p>Sort the scores of Statistics in ascending order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Statistics&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Sory the scores of both Statistics and Marketing in descending order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Marketing&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>For the parameter <code class="docutils literal notranslate"><span class="pre">by</span></code>, with “Statistics” preceding “Advanced Mathematics”, it means: first sort by Statistics scores in descending order, and for entries with identical Statistics scores, then sort by Advanced Mathematics scores in descending order.</p>
<p>Since column labels often get shuffled during sorting:</p>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">ignore_index</span> <span class="pre">=</span> <span class="pre">True</span></code> to reset the index labels sequentially.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">inplace</span> <span class="pre">=</span> <span class="pre">True</span></code> to modify the original DataFrame directly.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Marketing&quot;</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># reset the index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Marketing&quot;</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
<span class="n">df</span> <span class="c1"># the original data keeps same</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Marketing&quot;</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">df</span> <span class="c1"># the original data is changed after adding `inplace=True`</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Marketing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jack</td>
      <td>90</td>
      <td>88</td>
      <td>78</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jim</td>
      <td>85</td>
      <td>82</td>
      <td>84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lily</td>
      <td>68</td>
      <td>63</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="group-the-data-groupby">
<h3><span class="section-number">5.4.3. </span>Group the data <code class="docutils literal notranslate"><span class="pre">groupby</span></code><a class="headerlink" href="#group-the-data-groupby" title="Link to this heading">#</a></h3>
<hr>
<p>In data analysis, it’s often necessary to group and aggregate data. For example, when analyzing students’ final exam scores, you might need to calculate average scores, highest scores, etc. by major or class. Pandas’ <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> method conveniently implements these operations.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">groupby</span></code> operation is frequently combined with aggregation method such as:</p>
<ul class="simple">
<li><p>mean (average)</p></li>
<li><p>max (maximum value)</p></li>
<li><p>min (minimum value)</p></li>
<li><p>median (median)</p></li>
<li><p>std (standard deviation)</p></li>
<li><p>mad (mean absolute deviation)</p></li>
<li><p>count (number of non-null values)</p></li>
<li><p>size (total count, including nulls)</p></li>
<li><p>skew (skewness)</p></li>
<li><p>quantile (quantile values)</p></li>
</ul>
<p>Below is a DataFrame about transcript.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="s2">&quot;US&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;Tom&quot;</span><span class="p">,</span> <span class="s2">&quot;UK&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;Jack&quot;</span><span class="p">,</span> <span class="s2">&quot;India&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">78</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;David&quot;</span><span class="p">,</span> <span class="s2">&quot;UK&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">80</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;Ella&quot;</span><span class="p">,</span> <span class="s2">&quot;India&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">63</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;Julie&quot;</span><span class="p">,</span> <span class="s2">&quot;China&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">93</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Nation&quot;</span><span class="p">,</span> <span class="s2">&quot;Level&quot;</span><span class="p">,</span> <span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Accounting&quot;</span><span class="p">,</span> <span class="s2">&quot;Finance&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Nation</th>
      <th>Level</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Lily</td>
      <td>US</td>
      <td>5</td>
      <td>85</td>
      <td>68</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tom</td>
      <td>UK</td>
      <td>6</td>
      <td>82</td>
      <td>63</td>
      <td>88</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jack</td>
      <td>India</td>
      <td>6</td>
      <td>84</td>
      <td>90</td>
      <td>78</td>
    </tr>
    <tr>
      <th>3</th>
      <td>David</td>
      <td>UK</td>
      <td>6</td>
      <td>75</td>
      <td>68</td>
      <td>80</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ella</td>
      <td>India</td>
      <td>5</td>
      <td>69</td>
      <td>55</td>
      <td>63</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Julie</td>
      <td>China</td>
      <td>5</td>
      <td>89</td>
      <td>95</td>
      <td>93</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Level&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="c1"># group by &#39;Level&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Nation</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Finance</th>
    </tr>
    <tr>
      <th>Level</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Level&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Level
5    3
6    3
dtype: int64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">numeric_only</span> <span class="pre">=</span> <span class="pre">True</span></code> to operate only on the numeric values</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Level&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
    <span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>  <span class="c1"># Get the mean scores for each module by &quot;Level&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Finance</th>
    </tr>
    <tr>
      <th>Level</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>81.000000</td>
      <td>72.666667</td>
      <td>82.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>80.333333</td>
      <td>73.666667</td>
      <td>82.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Nation&quot;</span><span class="p">,</span> <span class="s2">&quot;Level&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Finance</th>
    </tr>
    <tr>
      <th>Nation</th>
      <th>Level</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>China</th>
      <th>5</th>
      <td>89.0</td>
      <td>95.0</td>
      <td>93.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">India</th>
      <th>5</th>
      <td>69.0</td>
      <td>55.0</td>
      <td>63.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>84.0</td>
      <td>90.0</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>UK</th>
      <th>6</th>
      <td>78.5</td>
      <td>65.5</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>US</th>
      <th>5</th>
      <td>85.0</td>
      <td>68.0</td>
      <td>90.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can assign the data after grouping to a new DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Nation&quot;</span><span class="p">,</span> <span class="s2">&quot;Level&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Finance</th>
    </tr>
    <tr>
      <th>Nation</th>
      <th>Level</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>China</th>
      <th>5</th>
      <td>89.0</td>
      <td>95.0</td>
      <td>93.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">India</th>
      <th>5</th>
      <td>69.0</td>
      <td>55.0</td>
      <td>63.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>84.0</td>
      <td>90.0</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>UK</th>
      <th>6</th>
      <td>78.5</td>
      <td>65.5</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>US</th>
      <th>5</th>
      <td>85.0</td>
      <td>68.0</td>
      <td>90.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MultiIndex([(&#39;China&#39;, &#39;5&#39;),
            (&#39;India&#39;, &#39;5&#39;),
            (&#39;India&#39;, &#39;6&#39;),
            (   &#39;UK&#39;, &#39;6&#39;),
            (   &#39;US&#39;, &#39;5&#39;)],
           names=[&#39;Nation&#39;, &#39;Level&#39;])
</pre></div>
</div>
</div>
</div>
</section>
<section id="method-reset-index-or-parameter-as-index-false">
<h3><span class="section-number">5.4.4. </span>Method <code class="docutils literal notranslate"><span class="pre">reset_index()</span></code> or parameter <code class="docutils literal notranslate"><span class="pre">as_index=False</span></code><a class="headerlink" href="#method-reset-index-or-parameter-as-index-false" title="Link to this heading">#</a></h3>
<hr>
<p>The indices of a DataFrame often change after Pandas processing, as have mentioned before, we have two ways to stop the changes.</p>
<ul class="simple">
<li><p>Use a method <code class="docutils literal notranslate"><span class="pre">reset_index()</span></code> after <code class="docutils literal notranslate"><span class="pre">goupby()</span></code>.</p></li>
<li><p>Use a parameter <code class="docutils literal notranslate"><span class="pre">as_index=False</span></code> inside <code class="docutils literal notranslate"><span class="pre">groupby()</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Nation&quot;</span><span class="p">,</span> <span class="s2">&quot;Level&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Nation</th>
      <th>Level</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>China</td>
      <td>5</td>
      <td>89.0</td>
      <td>95.0</td>
      <td>93.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>India</td>
      <td>5</td>
      <td>69.0</td>
      <td>55.0</td>
      <td>63.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>India</td>
      <td>6</td>
      <td>84.0</td>
      <td>90.0</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>UK</td>
      <td>6</td>
      <td>78.5</td>
      <td>65.5</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US</td>
      <td>5</td>
      <td>85.0</td>
      <td>68.0</td>
      <td>90.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Nation&quot;</span><span class="p">,</span> <span class="s2">&quot;Level&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Nation</th>
      <th>Level</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>China</td>
      <td>5</td>
      <td>89.0</td>
      <td>95.0</td>
      <td>93.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>India</td>
      <td>5</td>
      <td>69.0</td>
      <td>55.0</td>
      <td>63.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>India</td>
      <td>6</td>
      <td>84.0</td>
      <td>90.0</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>UK</td>
      <td>6</td>
      <td>78.5</td>
      <td>65.5</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US</td>
      <td>5</td>
      <td>85.0</td>
      <td>68.0</td>
      <td>90.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Sometimes, the <code class="docutils literal notranslate"><span class="pre">reset_index()</span></code> method can be used with the <code class="docutils literal notranslate"><span class="pre">drop=True</span></code> parameter to remove the index.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">reset_index()</span></code> method can also use the <code class="docutils literal notranslate"><span class="pre">names</span></code> parameter to rename column headers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Nation&quot;</span><span class="p">,</span> <span class="s2">&quot;Level&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Class&quot;</span><span class="p">,</span> <span class="s2">&quot;Gender&quot;</span><span class="p">])</span>
<span class="p">)</span> 
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Class</th>
      <th>Gender</th>
      <th>Statistics</th>
      <th>Accounting</th>
      <th>Finance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>China</td>
      <td>5</td>
      <td>89.0</td>
      <td>95.0</td>
      <td>93.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>India</td>
      <td>5</td>
      <td>69.0</td>
      <td>55.0</td>
      <td>63.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>India</td>
      <td>6</td>
      <td>84.0</td>
      <td>90.0</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>UK</td>
      <td>6</td>
      <td>78.5</td>
      <td>65.5</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US</td>
      <td>5</td>
      <td>85.0</td>
      <td>68.0</td>
      <td>90.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Class&#39;, &#39;Gender&#39;, &#39;Statistics&#39;, &#39;Accounting&#39;, &#39;Finance&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="to-a-numpy-array-or-a-list">
<h2><span class="section-number">5.5. </span>To a NumPy array or a list<a class="headerlink" href="#to-a-numpy-array-or-a-list" title="Link to this heading">#</a></h2>
<hr><p>In Pandas, the <code class="docutils literal notranslate"><span class="pre">values</span></code> method can convert DataFrame data into a NumPy array format. For example, using the previous data example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[&#39;Lily&#39;, &#39;US&#39;, &#39;5&#39;, 85, 68, 90],
       [&#39;Tom&#39;, &#39;UK&#39;, &#39;6&#39;, 82, 63, 88],
       [&#39;Jack&#39;, &#39;India&#39;, &#39;6&#39;, 84, 90, 78],
       [&#39;David&#39;, &#39;UK&#39;, &#39;6&#39;, 75, 68, 80],
       [&#39;Ella&#39;, &#39;India&#39;, &#39;5&#39;, 69, 55, 63],
       [&#39;Julie&#39;, &#39;China&#39;, &#39;5&#39;, 89, 95, 93]], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">,</span> <span class="s2">&quot;Accounting&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[85, 68],
       [82, 63],
       [84, 90],
       [75, 68],
       [69, 55],
       [89, 95]], dtype=int64)
</pre></div>
</div>
</div>
</div>
<p>You can also use the <code class="docutils literal notranslate"><span class="pre">tolist()</span></code> method to convert a column of data into Python’s native list type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Statistics&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[85, 82, 84, 75, 69, 89]
</pre></div>
</div>
</div>
</div>
</section>
<section id="apply-a-method">
<h2><span class="section-number">5.6. </span>Apply a method<a class="headerlink" href="#apply-a-method" title="Link to this heading">#</a></h2>
<hr>
<p>Pandas 可以使用<code class="docutils literal notranslate"><span class="pre">apply</span></code>调用自定义函数。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">df</span><span class="p">[</span><span class="s2">&quot;统计学&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">)</span>  <span class="c1"># 调用 Numpy 中的求平方根函数对统计学成绩每个元素求平方根</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">File C:\ProgramData\anaconda3\Lib\site-packages\pandas\core\indexes\base.py:3805,</span> in <span class="ni">Index.get_loc</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">3804</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3805</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">casted_key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3806</span> <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>

<span class="nn">File index.pyx:167,</span> in <span class="ni">pandas._libs.index.IndexEngine.get_loc</span><span class="nt">()</span>

<span class="nn">File index.pyx:196,</span> in <span class="ni">pandas._libs.index.IndexEngine.get_loc</span><span class="nt">()</span>

<span class="nn">File pandas\\_libs\\hashtable_class_helper.pxi:7081,</span> in <span class="ni">pandas._libs.hashtable.PyObjectHashTable.get_item</span><span class="nt">()</span>

<span class="nn">File pandas\\_libs\\hashtable_class_helper.pxi:7089,</span> in <span class="ni">pandas._libs.hashtable.PyObjectHashTable.get_item</span><span class="nt">()</span>

<span class="ne">KeyError</span>: &#39;统计学&#39;

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">87</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;统计学&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">)</span>

<span class="nn">File C:\ProgramData\anaconda3\Lib\site-packages\pandas\core\frame.py:4102,</span> in <span class="ni">DataFrame.__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">4100</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">4101</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_multilevel</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">4102</span> <span class="n">indexer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4103</span> <span class="k">if</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">indexer</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">4104</span>     <span class="n">indexer</span> <span class="o">=</span> <span class="p">[</span><span class="n">indexer</span><span class="p">]</span>

<span class="nn">File C:\ProgramData\anaconda3\Lib\site-packages\pandas\core\indexes\base.py:3812,</span> in <span class="ni">Index.get_loc</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">3807</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">casted_key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">3808</span>         <span class="nb">isinstance</span><span class="p">(</span><span class="n">casted_key</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3809</span>         <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">casted_key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3810</span>     <span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">3811</span>         <span class="k">raise</span> <span class="n">InvalidIndexError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3812</span>     <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
<span class="g g-Whitespace">   </span><span class="mi">3813</span> <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3814</span>     <span class="c1"># If we have a listlike key, _check_indexing_error will raise</span>
<span class="g g-Whitespace">   </span><span class="mi">3815</span>     <span class="c1">#  InvalidIndexError. Otherwise we fall through and re-raise</span>
<span class="g g-Whitespace">   </span><span class="mi">3816</span>     <span class="c1">#  the TypeError.</span>
<span class="g g-Whitespace">   </span><span class="mi">3817</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_check_indexing_error</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="ne">KeyError</span>: &#39;统计学&#39;
</pre></div>
</div>
</div>
</div>
<p>我们也可以使用<code class="docutils literal notranslate"><span class="pre">lambda</span></code>定义一个匿名函数在<code class="docutils literal notranslate"><span class="pre">apply</span></code>里面调用：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;高数新&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;高数&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># 对每一个高数成绩都减去 10 分，并赋值给一个新的列</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">apply</span></code> 也可以调用更复杂的自定义函数，例如，下面定义一个成绩替换函数，将分数替换为”优良中差”：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">replace_score</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">90</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;优&quot;</span>
    <span class="k">elif</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">80</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;良&quot;</span>
    <span class="k">elif</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">60</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;中&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;差&quot;</span>


<span class="n">df</span><span class="p">[</span><span class="s2">&quot;英语&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">replace_score</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h2><span class="section-number">5.7. </span>数据清洗<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<hr>
<section id="replace-fillna">
<h3><span class="section-number">5.7.1. </span>数据替换<code class="docutils literal notranslate"><span class="pre">replace</span></code>, <code class="docutils literal notranslate"><span class="pre">fillna</span></code><a class="headerlink" href="#replace-fillna" title="Link to this heading">#</a></h3>
<hr>
<p>在进行数据处理时，经常需要对原始数据的一些异常值或错误值进行批量处理。 Pandas 提供了<code class="docutils literal notranslate"><span class="pre">replace</span></code>函数方便地进行这项操作。<code class="docutils literal notranslate"><span class="pre">replace</span></code>函数第一项为原数据中的值，第二项为需要替换的值。例如，有下面的学生成绩：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="p">[</span><span class="mi">82</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span> <span class="p">[</span><span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">78</span><span class="p">]]),</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;统计学&quot;</span><span class="p">,</span> <span class="s2">&quot;高数&quot;</span><span class="p">,</span> <span class="s2">&quot;英语&quot;</span><span class="p">],</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;张三&quot;</span><span class="p">,</span> <span class="s2">&quot;李四&quot;</span><span class="p">,</span> <span class="s2">&quot;王五&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<p>将其中的分数 90 替换为缺失值 NaN，注意，<code class="docutils literal notranslate"><span class="pre">replace</span></code>返回了一个新的数据，但原始数据并没有改变。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>  <span class="c1"># 原始数据并没有变</span>
</pre></div>
</div>
</div>
</div>
<p>若需要原始数据改变，需要跟上参数<code class="docutils literal notranslate"><span class="pre">inplace</span> <span class="pre">=</span> <span class="pre">True</span> </code>，下面讲到的函数<code class="docutils literal notranslate"><span class="pre">fillna</span> </code>、<code class="docutils literal notranslate"><span class="pre">drop_duplicates</span></code>、<code class="docutils literal notranslate"><span class="pre">dropna</span></code>、 <code class="docutils literal notranslate"><span class="pre">rename</span></code>等也可以跟这个参数将原始数据改变。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span>  <span class="c1"># 原始数据改变了</span>
</pre></div>
</div>
</div>
</div>
<p>Pandas 提供<code class="docutils literal notranslate"><span class="pre">fillna</span></code>函数批量替换数据表中的缺失值 NaN。例如：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>  <span class="c1"># 将缺失值替换为 80</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;missing&quot;</span><span class="p">)</span>  <span class="c1"># 将缺失值替换为一个字符串</span>
</pre></div>
</div>
</div>
</div>
<p>Pandas 还可以直接调用<code class="docutils literal notranslate"><span class="pre">isnull</span></code>函数判断数据是否为缺失值：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;英语&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="astype">
<h3><span class="section-number">5.7.2. </span>数据类型转换 <code class="docutils literal notranslate"><span class="pre">astype</span></code><a class="headerlink" href="#astype" title="Link to this heading">#</a></h3>
<hr>
<p>很多时候，我们需要对原始数据进行数据转换。例如，一些原始数据中的数字为文本类型，我们需要讲它们转化为数值类型才能进行之后的计算操作。常见的数据类型转换函数为<code class="docutils literal notranslate"><span class="pre">astype</span></code>。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s2">&quot;85&quot;</span><span class="p">,</span> <span class="s2">&quot;68&quot;</span><span class="p">,</span> <span class="s2">&quot;90&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;82&quot;</span><span class="p">,</span> <span class="s2">&quot;63&quot;</span><span class="p">,</span> <span class="s2">&quot;88&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;84&quot;</span><span class="p">,</span> <span class="s2">&quot;90&quot;</span><span class="p">,</span> <span class="s2">&quot;78&quot;</span><span class="p">]]),</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;统计学&quot;</span><span class="p">,</span> <span class="s2">&quot;高数&quot;</span><span class="p">,</span> <span class="s2">&quot;英语&quot;</span><span class="p">],</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;张三&quot;</span><span class="p">,</span> <span class="s2">&quot;李四&quot;</span><span class="p">,</span> <span class="s2">&quot;王五&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>上面的 pandas 数据为文本类型，我们利用<code class="docutils literal notranslate"><span class="pre">astype</span></code>将其转化为浮点型数值类型。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;统计学&quot;</span><span class="p">,</span> <span class="s2">&quot;高数&quot;</span><span class="p">,</span> <span class="s2">&quot;英语&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>改变<code class="docutils literal notranslate"><span class="pre">as_type</span></code>小括号中的参数为 int，str等，我们同样可以将原始数据转化为整数型，字符串型等。</p>
</section>
<section id="drop-duplicates">
<h3><span class="section-number">5.7.3. </span>重复值处理<code class="docutils literal notranslate"><span class="pre">drop_duplicates</span></code><a class="headerlink" href="#drop-duplicates" title="Link to this heading">#</a></h3>
<hr>
<p>在数据量比较大时，经常会遇到重复数据的问题，可以使用函数<code class="docutils literal notranslate"><span class="pre">drop_duplicates</span></code>将重复数据去掉。例如：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;一班&quot;</span><span class="p">,</span> <span class="s2">&quot;男&quot;</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;一班&quot;</span><span class="p">,</span> <span class="s2">&quot;男&quot;</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;二班&quot;</span><span class="p">,</span> <span class="s2">&quot;女&quot;</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">78</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;三班&quot;</span><span class="p">,</span> <span class="s2">&quot;女&quot;</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">80</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;二班&quot;</span><span class="p">,</span> <span class="s2">&quot;女&quot;</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">63</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;一班&quot;</span><span class="p">,</span> <span class="s2">&quot;男&quot;</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">93</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;班级&quot;</span><span class="p">,</span> <span class="s2">&quot;性别&quot;</span><span class="p">,</span> <span class="s2">&quot;统计学&quot;</span><span class="p">,</span> <span class="s2">&quot;高数&quot;</span><span class="p">,</span> <span class="s2">&quot;英语&quot;</span><span class="p">],</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;张三&quot;</span><span class="p">,</span> <span class="s2">&quot;张三&quot;</span><span class="p">,</span> <span class="s2">&quot;王五&quot;</span><span class="p">,</span> <span class="s2">&quot;马六&quot;</span><span class="p">,</span> <span class="s2">&quot;陈小虎&quot;</span><span class="p">,</span> <span class="s2">&quot;魏大帅&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<p>前两行的数据完全相同，使用函数<code class="docutils literal notranslate"><span class="pre">drop_duplicates</span></code>处理：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">drop_duplicates</span></code>的语法如下：</p>
<table>
     <tr style="border-top:solid; border-bottom:solid">
            <th colspan=2 style="text-align:center">DataFrame.drop_duplicates(keep='first', inplace=False, ignore_index=False)</th>
    </tr>
    <tr>
        <td rowspan=3 style="text-align:left">keep</td>
        <td style="text-align:left">'fist'表示除了第一个重复的行都删除</td>
    </tr>
    <tr>
        <td style="text-align:left">'last'表示除了最后一个重复的行都删除</td>
    </tr>
    <tr>
        <td style="text-align:left">False 表示删除所有重复的行</td>
    </tr>
    <tr>
        <td style="text-align:left">inplace</td>
        <td style="text-align:left">若 inplace=True，表示处理后的数据替换原数据</td>
    </tr>
    <tr style="border-bottom:solid">
        <td style="text-align:left">ignore_index</td>
        <td style="text-align:left">如果为 True，则排序后的行号重新标号，默认是 False</td>
    </tr>
</table>
</br></section>
<section id="drop-na">
<h3><span class="section-number">5.7.4. </span>缺失值处理<code class="docutils literal notranslate"><span class="pre">drop_na</span></code><a class="headerlink" href="#drop-na" title="Link to this heading">#</a></h3>
<hr>
<p><code class="docutils literal notranslate"><span class="pre">dropna</span></code>函数可以将数据表中包含缺失值的行去除掉，与<code class="docutils literal notranslate"><span class="pre">drop_duplicates</span></code>的语法类似。它的语法如下：</p>
<table>
     <tr style="border-top:solid; border-bottom:solid">
            <th colspan=2 style="text-align:center">DataFrame.dropna(axis=0, how='any', thresh=None, inplace=False, ignore_index=False)</th>
    </tr>
    <tr>
        <td style="text-align:left">axis</td>
        <td style="text-align:left">axis=0 表示删除含空值所在行，axis=1 表示删除含空值所在列</td>
    </tr>
    <tr>
        <td rowspan=2 style="text-align:left">how</td>
        <td style="text-align:left">默认为 how='any'，表示若有空值，就删除</td>
    </tr>
    <tr>  
        <td style="text-align:left">how='all'，表示全部是空值才删除该行或该列</td>
    </tr>
    <tr>
        <td style="text-align:left">thresh</td>
        <td style="text-align:left">空值的个数，作为行或列的删除标准</td>
    </tr>
    <tr>
        <td style="text-align:left">inplace</td>
        <td style="text-align:left">若 inplace=True，表示处理后的数据替换原数据</td>
    </tr>
    <tr style="border-bottom:solid">
        <td style="text-align:left">ignore_index</td>
        <td style="text-align:left">如果为 True，则排序后的行号重新标号，默认是 False</td>
    </tr>
</table>
</br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;统计学&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="s2">&quot;高数&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">82</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span> <span class="s2">&quot;英语&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">78</span><span class="p">]},</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;张三&quot;</span><span class="p">,</span> <span class="s2">&quot;李四&quot;</span><span class="p">,</span> <span class="s2">&quot;王五&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>  <span class="c1"># 默认为删除含有空值的行，并且只要行里面有 Nan 值，就删除</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># 删除含有空值的列</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>  <span class="c1"># 全部是空值才删除</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="rename">
<h3><span class="section-number">5.7.5. </span>重命名<code class="docutils literal notranslate"><span class="pre">rename</span></code><a class="headerlink" href="#rename" title="Link to this heading">#</a></h3>
<hr>
<p>在处理数据表时，有时候要给数据的行名或列名重命名，此时要用到<code class="docutils literal notranslate"><span class="pre">rename</span></code>函数，<code class="docutils literal notranslate"><span class="pre">rename</span></code>函数中的参数为一个字典形式：替换前的名字为字典的 key，替换后的名字为字典的 value。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;统计学&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="s2">&quot;高数&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">82</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span> <span class="s2">&quot;英语&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">78</span><span class="p">]})</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;统计学&quot;</span><span class="p">:</span> <span class="s2">&quot;科目A&quot;</span><span class="p">,</span> <span class="s2">&quot;高数&quot;</span><span class="p">:</span> <span class="s2">&quot;科目B&quot;</span><span class="p">})</span>  <span class="c1"># 更改其中两列的列名</span>
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">tip</p>
<p>若要处理后的数据替换原数据，则要加参数<code class="docutils literal notranslate"><span class="pre">inplace=True</span></code></p>
</div>
</section>
</section>
<section id="id2">
<h2><span class="section-number">5.8. </span>时间序列数据处理<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<hr>
<section id="to-datetime-dt-strftime">
<h3><span class="section-number">5.8.1. </span><code class="docutils literal notranslate"><span class="pre">to_datetime</span></code> 与 <code class="docutils literal notranslate"><span class="pre">dt.strftime</span></code><a class="headerlink" href="#to-datetime-dt-strftime" title="Link to this heading">#</a></h3>
<hr>
<p>实际工作中，经常会遇到大量的时间序列数据。这些时间序列的原始数据一般为文本格式，我们需要将它转化为时间日期格式。 Pandas 提供了 <code class="docutils literal notranslate"><span class="pre">to_datetime</span></code>函数将其他日期时间格式转化为 Python 的日期时间格式。例如：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;20200514&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;2020/05/14&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;2020-05-14&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>在上面的代码中可以看出，<code class="docutils literal notranslate"><span class="pre">to_datetime</span></code>方法将不同类型的时间数据字符串转化为 Timestamp 格式：<code class="docutils literal notranslate"><span class="pre">年-月-日</span> <span class="pre">时:分:秒</span></code>。另外一个函数<code class="docutils literal notranslate"><span class="pre">dt.strftime</span></code>可以将 Pandas 的 Timestamp 格式数据转化为其他格式的字符串，例如：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;入校时间&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2016-09-15&quot;</span><span class="p">,</span> <span class="s2">&quot;2017-03-23&quot;</span><span class="p">,</span> <span class="s2">&quot;2018-09-05&quot;</span><span class="p">],</span>
        <span class="s2">&quot;统计学&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
        <span class="s2">&quot;高数&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">82</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span>
        <span class="s2">&quot;英语&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">78</span><span class="p">],</span>
        <span class="s2">&quot;姓名&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;张三&quot;</span><span class="p">,</span> <span class="s2">&quot;李四&quot;</span><span class="p">,</span> <span class="s2">&quot;王五&quot;</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># 原始数据中的时间为字符串</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;入校时间&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;入校时间&quot;</span><span class="p">])</span>  <span class="c1"># 将原始数据中的时间转化为 python 的日期格式</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;入校时间&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%m-</span><span class="si">%d</span><span class="s2">-%y&quot;</span><span class="p">)</span>  <span class="c1"># 将日期格式转化为自定义格式的字符串</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;入校时间&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%B-</span><span class="si">%d</span><span class="s2">-%y&quot;</span><span class="p">)</span>  <span class="c1"># 将日期格式转化为自定义格式的字符串，小写 Y 年份显示两位</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;入校时间&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%B-</span><span class="si">%d</span><span class="s2">-%Y&quot;</span><span class="p">)</span>  <span class="c1"># 将日期格式转化为自定义格式的字符串，大写 Y 则年份显示四位</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;入校时间&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%W&quot;</span><span class="p">)</span>  <span class="c1"># 将日期格式转化为自定义格式的字符串，大写 W 显示的为该年第几周</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;入校时间&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-%w&quot;</span><span class="p">)</span>  <span class="c1"># 将日期格式转化为自定义格式的字符串，小写 w 显示的为该月第几周</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="resample">
<h3><span class="section-number">5.8.2. </span>数据聚合函数<code class="docutils literal notranslate"><span class="pre">resample</span></code><a class="headerlink" href="#resample" title="Link to this heading">#</a></h3>
<hr>
<p>对于很多时间序列数据，有时候经常需要对它们按一定周期进行数据聚合，可以用 Pandas 提供的<code class="docutils literal notranslate"><span class="pre">resample</span></code>函数。resample 方法中的小括号中用不同参数表示聚合的频率。举例：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;12/24/2019&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>  <span class="c1"># 生成一个时间序列，频率为天，周期数为 10</span>
<span class="n">index</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>  <span class="c1"># 创建一个包含时间序列的 DataFrame 数据表</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># 用 resample 方法按月(&#39;M&#39;)对数据聚合</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;3D&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># 用 resample 方法每 3 天(&#39;3D&#39;)对数据聚合</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># 用 resample 方法每周(&#39;w&#39;)对数据聚合</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">resample</span></code>的其他参数中， ‘T’ 表示分钟，‘H’ 表示小时，除了跟<code class="docutils literal notranslate"><span class="pre">sum()</span></code>方法外，还可以跟<code class="docutils literal notranslate"><span class="pre">asfreq()</span></code>，<code class="docutils literal notranslate"><span class="pre">ffill</span></code>，<code class="docutils literal notranslate"><span class="pre">apply()</span></code>等。</p>
</section>
</section>
<section id="pandas-draw-picutres-1">
<h2><span class="section-number">5.9. </span>Pandas draw picutres*<a class="footnote-reference brackets" href="#id4" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a><a class="headerlink" href="#pandas-draw-picutres-1" title="Link to this heading">#</a></h2>
<hr>
<p>除了结合 matplotlib 与 seaborn 画图外，Pandas 也有自己的画图函数<code class="docutils literal notranslate"><span class="pre">plot</span></code>，它的语法一般为：</p>
<table>
     <tr style="border-top:solid; border-bottom:solid">
            <th colspan=2 style="text-align:center">DataFrame.plot(x=None,y=None, kind='line',subplots=False, title=None)</th>
    </tr>
    <tr>
        <td style="text-align:left">x</td>
        <td style="text-align:left">横坐标数据</td>
    </tr>
    <tr>
        <td style="text-align:left">y</td>
        <td style="text-align:left">纵坐标数据</td>
    </tr>
    <tr>  
        <td style="text-align:left">kind</td>
        <td style="text-align:left">默认是线图，还可以是‘bar’,'barh','box','pie','scatter','hist'等</td>
    </tr>
    <tr>
        <td style="text-align:left">subplots</td>
        <td style="text-align:left">是否将每一列数据分别生成一个子图</td>
    </tr>
    <tr style="border-bottom:solid">
        <td style="text-align:left">title</td>
        <td style="text-align:left">图形的标题</td>
    </tr>
</table>
</br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="s2">&quot;math&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">82</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span> <span class="s2">&quot;English&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">78</span><span class="p">]}</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>从上图可以看出，Pandas 的<code class="docutils literal notranslate"><span class="pre">plot</span></code>默认对每一列数据，画一个线图。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;My picture&quot;</span><span class="p">)</span>  <span class="c1"># 画出柱状图</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># 对每一列数据非别生成一个子图</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;math&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;statistics&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;scatter&quot;</span><span class="p">)</span>  <span class="c1"># 指定横坐标与纵坐标，生成一个散点图</span>
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">tip</p>
<p>pandas 有大量处理数据的函数以及众多参数设置，限于篇幅关系，本书不详细赘述。读者使用 pandas 处理数据时，可以进一步查阅官方文档。</p>
</div>
</section>
<section id="exercises">
<h2><span class="section-number">5.10. </span>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<hr><div class="exercise admonition" id="creat-df">

<p class="admonition-title"><span class="caption-number">Exercise 5.1 </span></p>
<section id="exercise-content">
<p>How to creat a DataFrame for the following panel data?</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Nation</p></th>
<th class="head"><p>Capital</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>UK</p></td>
<td><p>London</p></td>
</tr>
<tr class="row-odd"><td><p>US</p></td>
<td><p>Washington DC</p></td>
</tr>
<tr class="row-even"><td><p>China</p></td>
<td><p>Beijing</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-1">

<p class="admonition-title">Solution to<a class="reference internal" href="#creat-df"> Exercise 5.1</a></p>
<section id="solution-content">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Nation&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;UK&#39;</span><span class="p">,</span> <span class="s1">&#39;US&#39;</span><span class="p">,</span> <span class="s1">&#39;China&#39;</span><span class="p">],</span> <span class="s1">&#39;Capital&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;London&#39;</span><span class="p">,</span> <span class="s1">&#39;Washinton DC&#39;</span><span class="p">,</span> <span class="s1">&#39;Beijing&#39;</span><span class="p">]})</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s1">&#39;UK&#39;</span><span class="p">,</span> <span class="s1">&#39;US&#39;</span><span class="p">,</span> <span class="s1">&#39;China&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;London&#39;</span><span class="p">,</span> <span class="s1">&#39;Washinton DC&#39;</span><span class="p">,</span> <span class="s1">&#39;Beijing&#39;</span><span class="p">]])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Nation&#39;</span><span class="p">,</span> <span class="s1">&#39;Capital&#39;</span><span class="p">])</span>
</pre></div>
</div>
</section>
</div>
<div class="exercise admonition" id="read-csv">

<p class="admonition-title"><span class="caption-number">Exercise 5.2 </span></p>
<section id="exercise-content">
<p>How to read a CSV file into a Pandas DataFrame?</p>
<p>A.    pd.load_csv()</p>
<p>B.    pd.read_csv()</p>
<p>C.    pd.open_csv()</p>
<p>D.    pd.import_csv()</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-3">

<p class="admonition-title">Solution to<a class="reference internal" href="#read-csv"> Exercise 5.2</a></p>
<section id="solution-content">
<p>B</p>
</section>
</div>
<div class="exercise admonition" id="row-index">

<p class="admonition-title"><span class="caption-number">Exercise 5.3 </span></p>
<section id="exercise-content">
<p>What is the default index type when a DataFrame is created?</p>
<p>A.    Numeric index starting from 1</p>
<p>B.    Alphanumeric index based on row number</p>
<p>C.    Numeric index starting from 0</p>
<p>D.    Strings</p>
</section>
</div>
<div class="solution dropdown admonition" id="introduction-to-pandas-solution-5">

<p class="admonition-title">Solution to<a class="reference internal" href="#row-index"> Exercise 5.3</a></p>
<section id="solution-content">
<p>C</p>
</section>
</div>
<div class="exercise admonition" id="pandas-read">

<p class="admonition-title"><span class="caption-number">Exercise 5.4 </span></p>
<section id="exercise-content">
<p>自定义一个包含10个学生，3门课程的成绩单 excel 文件，其中包含不及格的数据。用 pandas 读取该文件，剔除有成绩不及格的学生条目，并输出剩下成绩单各科目的平均成绩，最高成绩；最后将剩下学生所有科目的平均成绩排序并输出名次。</p>
</section>
</div>
<script src="https://giscus.app/client.js"
        data-repo="robinchen121/book-Python-Data-Science"
        data-repo-id="R_kgDOKFdyOw"
        data-category="Announcements"
        data-category-id="DIC_kwDOKFdyO84CgWHi"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script><!-- Toogle google translation -->
<div id="google_translate_element"></div>
<script type="text/javascript">
      function googleTranslateElementInit() {
        new google.translate.TranslateElement({ pageLanguage: 'zh-CN',
                  includedLanguages: 'en,zh-CN,zh-TW,ja,ko,de,ru,fr,es,it,pt,hi,ar,fa',
layout: google.translate.TranslateElement.InlineLayout.SIMPLE }, 'google_translate_element');
      }
</script>
<script type="text/javascript"
      src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"
></script>
<br><script src="https://giscus.app/client.js"
        data-repo="robinchen121/book-Python-Data-Science"
        data-repo-id="R_kgDOKFdyOw"
        data-category="Announcements"
        data-category-id="DIC_kwDOKFdyO84CgWHi"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script><hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id4" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">1</a><span class="fn-bracket">]</span></span>
<p>* means this section may not be delivered in class.</p>
</aside>
</aside>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "RobinChen121/book-Python-Data-Science-en",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "conda-base-py"
        },
        kernelOptions: {
            name: "conda-base-py",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'conda-base-py'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="introduction-to-numpy.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Introduction to Numpy</p>
      </div>
    </a>
    <a class="right-next"
       href="define-function.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Define functions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-reading-and-storing-data">5.1. Creating, Reading, and Storing Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-data">5.1.1. Creating Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-data">5.1.2. Reading Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#store-the-data">5.1.3. Store the data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#access-and-change-data">5.2. Access and change data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-the-data-of-a-single-row-column-or-cell">5.2.1. Access the data of a single row, column or cell</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#acess-multi-row-or-multi-column-data">5.2.2. Acess multi-row or multi-column data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#view-the-statistical-values-of-the-data">5.2.3. View the statistical values of the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#revise-data">5.2.4. Revise data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-delete-and-merge-data">5.3. Add, delete and merge data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-data">5.3.1. Add data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#delete-data">5.3.2. Delete data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-data">5.3.3. Merge data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#search-sort-and-group-the-data">5.4. Search, sort and group the data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#search-data">5.4.1. Search data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sort-data">5.4.2. Sort data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#group-the-data-groupby">5.4.3. Group the data <code class="docutils literal notranslate"><span class="pre">groupby</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#method-reset-index-or-parameter-as-index-false">5.4.4. Method <code class="docutils literal notranslate"><span class="pre">reset_index()</span></code> or parameter <code class="docutils literal notranslate"><span class="pre">as_index=False</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#to-a-numpy-array-or-a-list">5.5. To a NumPy array or a list</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apply-a-method">5.6. Apply a method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">5.7. 数据清洗</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#replace-fillna">5.7.1. 数据替换<code class="docutils literal notranslate"><span class="pre">replace</span></code>, <code class="docutils literal notranslate"><span class="pre">fillna</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#astype">5.7.2. 数据类型转换 <code class="docutils literal notranslate"><span class="pre">astype</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#drop-duplicates">5.7.3. 重复值处理<code class="docutils literal notranslate"><span class="pre">drop_duplicates</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#drop-na">5.7.4. 缺失值处理<code class="docutils literal notranslate"><span class="pre">drop_na</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rename">5.7.5. 重命名<code class="docutils literal notranslate"><span class="pre">rename</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">5.8. 时间序列数据处理</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#to-datetime-dt-strftime">5.8.1. <code class="docutils literal notranslate"><span class="pre">to_datetime</span></code> 与 <code class="docutils literal notranslate"><span class="pre">dt.strftime</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resample">5.8.2. 数据聚合函数<code class="docutils literal notranslate"><span class="pre">resample</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-draw-picutres-1">5.9. Pandas draw picutres*</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">5.10. Exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Zhen Chen
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>